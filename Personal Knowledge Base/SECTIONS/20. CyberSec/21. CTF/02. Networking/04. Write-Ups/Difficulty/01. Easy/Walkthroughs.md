
# Network Traffic Analysis

**Платформа:**
**Уровень:** Easy


Я буду использовать Wireshark для прохождения. Еще один возможный инструмент для использования - Network Miner. Файл вызова june2020.pcapng состоит из двенадцати вопросов.

Вопрос 1. Сколько запросов ping было отправлено при захвате june2020.pcapng?

Откройте захват пакетов и примените следующий фильтр: "icmp.type == 8". Этот фильтр покажет все пакеты ICMP (также известные как ping), которые относятся к типу 8, что является эхо-запросом. Обратите внимание, что в нижней части экрана Wireshark таких пакетов шесть.

![[Pasted image 20240214155908.png]]

Вопрос 2. Какой IP-адрес устройства связан с 08:00:27:4b:e3:60?

Мы ищем MAC-адрес, который представляет собой шестибайтовое шестнадцатеричное значение, разделенное двоеточиями. Используйте функцию «найти» для поиска шестнадцатеричного значения 08:00:27:4b:e3:60. Поиск можно вызвать с помощью команды «Правка» > «Найти пакет» или выбрав увеличительное стекло в строке меню. Любой метод покажет нам пакеты, содержащие это значение.

Углубляясь в один из результатов «поиска», показанных в кадре No 9, мы видим, что 08:00:27:4b:e3:60 является исходным MAC-адресом. Оттуда мы также видим, что соответствующий исходный IP-адрес - 10.0.2.15.

![[Pasted image 20240214160001.png]]

Вопрос 3. Какая версия протокола управления группами Интернета используется?

Мы также будем использовать фильтр, чтобы ответить на этот вопрос, просто «igmp». Мы можем видеть версию как в области списка пакетов, так и в области сведений о пакете, которая является версией 3.

![[Pasted image 20240214160019.png]]

Вопрос 4. Как называется хост, расположенный в 10.0.2.22?

Имена узлов могут быть идентифицированы в трафике протокола DHCP (Dynamic Host Configuration Protocol). Используя фильтр «dhcp и ip.src == 10.0.2.22», мы можем идентифицировать этот трафик и наблюдать имя хоста «kali» в области сведений о пакетах для каждого из результирующих пакетов. Кали, конечно же, относится к дистрибутиву Kali Linux для тестирования на проникновение, который я часто выбираю в качестве «злоумышленника» в моей виртуальной лабораторной среде.

![[Pasted image 20240214160323.png]]

Вопрос 5. Что такое IP-адрес DHCP-сервера?

Фильтр, используемый в вопросе 4, также может быть использован для ответа на этот вопрос с небольшой модификацией, чтобы сделать 10.0.2.22 IP-адресом назначения по сравнению с источником, т.е. «dhcp и ip.dst == 10.0.2.22». В этом случае нам нужен IP-адрес DHCP-сервера, другими словами, устройства, отвечающего на запросы DHCP, поэтому этот фильтр покажет нам ответы на запросы, сделанные 10.0.2.22. IP-адрес DHCP-сервера, как показано в поле идентификатора сервера, — 10.0.2.3.

![[Pasted image 20240214160336.png]]

Вопрос 6. Как называется хост, расположенный в 10.0.2.15?

В этом случае мы будем искать активность протокола SMB, которая включает в себя объявления хоста. Мы можем использовать фильтр «smb и ip.addr == 10.0.2.15». Детализация в области списка пакетов или области сведений о пакете определит, что имя узла, объявленное для версии 10.0.2.15, — MSEDGEWIN10.

![[Pasted image 20240214160352.png]]

Вопрос 7. Какой IP-адрес у злоумышленника?

На этот вопрос может быть немного сложнее ответить, потому что мы должны определить активность атаки при захвате. Полезным методом является изучение различных протоколов, отображаемых в захвате, что можно сделать, выбрав «Статистика» > «Иерархия протоколов». Затем выберите «данные» в разделе «Протокол управления передачей» и щелкните правой кнопкой мыши, чтобы применить его в качестве фильтра. Мы также хотим применить «индекс потока» в качестве столбца, что можно сделать, выбрав любой из перечисленных пакетов TCP и детализировав панель сведений о пакете в разделе «Протокол управления передачей» и выбрав поле индекса потока. Затем щелкните правой кнопкой мыши это поле и выберите «применить в качестве столбца».

Теперь, когда вы применили столбец индекса потока, выберите индекс потока TCP 2 и щелкните правой кнопкой мыши один из двух показанных пакетов, а затем выберите Следовать > потоку TCP. Выходные данные показывают нам слова «тест» и «тестирование», которые отправляются с IP-адреса 10.0.2.22. Анализ активности в последующих потоках подтверждает, что это вероятный IP-адрес злоумышленника, и злоумышленник, по-видимому, имеет удаленный доступ к ящику жертвы.

![[Pasted image 20240214160404.png]]

Вопрос 8. Какую первую команду выполнил злоумышленник?

Мы уже видели, что фильтрация данных и отслеживание TCP-потоков позволяет нам видеть активность злоумышленников. Для этого вопроса мы собираемся следовать индексу потока TCP 5, который показывает множество действий злоумышленников. Здесь мы можем найти первую команду «whoami».

![[Pasted image 20240214160416.png]]

Вопрос 9. Каков идентификатор процесса сеанса RDP?

Этот вопрос также относится к индексу потока TCP 5. Есть выходные данные от злоумышленника, выполняющего команду «netstat -ano». Оттуда мы можем найти номер порта для протокола удаленного рабочего стола (RDP) 3389, указанный в одном из установленных соединений между 10.0.2.15 и 10.0.2.22, и связанный с ним идентификатор процесса (PID) 552.

![[Pasted image 20240214160430.png]]

Вопрос 10. Каков максимальный срок действия пароля для IEUser?

На этот вопрос также можно ответить, просмотрев индекс потока TCP 5. В этом случае мы ищем вывод команды «net accounts», которая дает нам максимальный возраст пароля 42 дня.

![[Pasted image 20240214160443.png]]

Вопрос 11. Каков путь к файлу для размещения анализа оборотного капитала.xls?

Опять же, мы рассмотрим индекс потока TCP 5 и, в частности, выходные данные команды «dir», выполняемой в папке «Документы» жертвы. Это показывает нам путь к файлу C:\Users\IEUser\Documents для анализа оборотного капитала файла.xls.

![[Pasted image 20240214160455.png]]

Вопрос 12. Какой посыл скрыт в комментариях?

Подсказкой здесь является слово «комментарии», так как это файл pcapng, который позволяет добавлять комментарии к захвату. Выберите «Анализировать» > «Экспертная информация» и щелкните кадр 1, который идентифицирован как комментарий. Оттуда мы видим комментарий «флаг: анализ pcap - это весело!».

![[Pasted image 20240214160505.png]]

Теперь вы использовали поиск, фильтры и последующие потоки, чтобы найти ответы на все двенадцать задач, молодцы! Как всегда, есть много способов найти решения этих проблем, и я показал вам только один для каждого из них. Я всегда рад услышать ваши методы, так что не стесняйтесь делиться в комментариях!

---

# FTP authentication

**Платформа:** https://www.root-me.org
**Уровень:** Easy

![[Pasted image 20230625223938.png]]

В данном задании нам предлагают найти аутентификационные данные из дампа трафика. При этом говорят, что это FTP. Открываем PCAP файл в wireshark.

![[Pasted image 20230625223949.png]]

Первым делом отфильтруем данные, так как нам нужен только протокол FTP.

![[Pasted image 20230625224008.png]]

Теперь отобразим трафик по потокам. Для этого после нажатия правой клавишей мыши выбираем Follow TCP Stream.

![[Pasted image 20230625224026.png]]

Видим логин и пароль пользователя.

![[Pasted image 20230625224040.png]]

---

# Telnet authentication

**Платформа:** https://www.root-me.org
**Уровень:** Easy

![[Pasted image 20230625224106.png]]

Задание похоже на предыдущее.

![[Pasted image 20230625224117.png]]

Забираем логин и пароль.

![[Pasted image 20230625224138.png]]

---

# Ethernet frame

**Платформа:** https://www.root-me.org
**Уровень:** Easy

![[Pasted image 20230625224325.png]]

Нам дают Hex представление пакета Ethernet протокола и просят найти конфиденциальные данные. Дело в том, что протоколы инкапсулированы один в другой. То есть в области данных протокола ethernet расположен протокол IP, в области данных которого расположен протокол TCP, в нем HTTP, где и расположены данные. То есть нам необходимо только декодировать символы из hex вида.

![[Pasted image 20230625224416.png]]

В заголовке HTTP есть данные Basiс-утентификации. Декодируем их из Base64.

![[Pasted image 20230625224431.png]]

---

# Twitter authentication

**Платформа:** https://www.root-me.org
**Уровень:** Easy

![[Pasted image 20230625224516.png]]

Нас просят найти пароль для входа на twitter из дампа трафика.

![[Pasted image 20230625224526.png]]

Там всего один пакет. Откроем его, выполнив двойной клик.

![[Pasted image 20230625224544.png]]

И снова видим данные Basic-аутентификации.

![[Pasted image 20230625224557.png]]

Находим логин и пароль.

---

# The Grinch Really Did Steal Christmas

**Платформа:** https://tryhackme.com/
**Уровень:** Easy
**Комната**: [Advent of Cyber 2](https://tryhackme.com/room/adventofcyber2)

**Вопрос № 1 Откройте «pcap1.pcap» в Wireshark. Какой IP-адрес инициирует ICMP/пинг?**

Сегодня мы меняем темп, решая сетевую проблему. Загрузите предоставленный файл и откройте **pcap1** в Wireshark.

Оттуда отфильтруйте запросы по протоколу ICMP:

![[Pasted image 20240814075215.png]]

Этот первый исходный адрес — это то, что мы ищем: **10.11.3.2.**

**Вопрос №2. Если бы мы хотели видеть в нашем файле «pcap1.pcap» только HTTP-запросы GET, какой фильтр мы бы использовали?**

Используйте следующее:

![[Pasted image 20240814075735.png]]

**Вопрос №3. Теперь примените этот фильтр к «pcap1.pcap» в Wireshark. Как называется статья, которую посетил IP-адрес «10.10.67.199»** ?

Если вы посмотрите вниз, вы увидите, что **пост с названием « олень недели ».** был посещен

![[Pasted image 20240814075810.png]]

**Вопрос №4. Приступим к анализу «pcap2.pcap». Посмотрите на захваченный FTP-трафик; какой пароль был раскрыт во время входа в систему? Здесь много нерелевантных данных. Здесь будет полезно использовать фильтр!**

Начните с использования фильтра, чтобы сосредоточиться только на трафике FTP (порт 21):

![[Pasted image 20240814075825.png]]

Если вы посмотрите немного внимательнее, вы увидите, что кто-то попробовал пароль Эльфа Макскиди, **Plaintext_password_fiasco** .

![[Pasted image 20240814075838.png]]

**Вопрос №5 Продолжая наш анализ «pcap2.pcap», как называется зашифрованный протокол?**

Глядя на трафик, вы увидите **некоторый SSH- трафик, который явно зашифрован:** в самом верху

![[Pasted image 20240814075925.png]]

В этом файле много пакетов, использующих разные типы протоколов для передачи данных по сети. Единственный зашифрованный протокол здесь - SSH. Так что ответ **SSH**

**Вопрос №6 Проанализируйте «pcap3.pcag» и восстановите Рождество** ! **Что в списке желаний Эльфа МакСкиди будет использовано вместо Эльфа МакИгера?**

Просматривая пакеты, вы увидите, что был передан файл с именем «christmas.zip».

![[Pasted image 20240814075956.png]]

поэтому в файле pcap, когда эльфы передают файл, они должны использовать метод http, поэтому введите **http.request.method**

![[Pasted image 20240814080345.png]]

Вы можете увидеть, что есть 2 пакета, если вы следите за потоком TCP во втором пакете, вы можете увидеть вызов файлаishlist.txt, но он в закодированном формате, поэтому файл должен быть во втором пакете. Теперь нам нужно извлечь файл из второго пакета.

Чтобы получить его, поднимитесь вверх и выберите экспорт объектов HTTP:

![[Pasted image 20240814080033.png]]

Отсюда вы можете выделить нужный объект и сохранить его как «christmas.zip» на своем компьютере:

![[Pasted image 20240814080047.png]]

чтобы получить это, вам нужно выбрать второй пакет и перейти в файл → экспортировать объект → http. Вы получите такое окно, затем выберите файл Christmas.zip и нажмите «Сохранить». ZIP-файл будет сохранен на вашем компьютере.


![[Pasted image 20240814080114.png]]

Итак, это список желаний, поэтому ответ: **«Резиновая уточка».**