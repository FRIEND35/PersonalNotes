# Что такое null byte injection?

 Null Byte Injection или же Инъекция Нулевого Байта - Это обход фильтров проверки веб-приложений, путем добавления нулевого байта (%00, 0x00 или же ``\0`` ) в конец строки URL.

**Почему так:**
  
  PHP напаисан на Си, и пришло им от СИ, т.е. в Си нулевой байт (0x00 или %00) лзначает конец строки. Это инъекция позволяет изменять логику работы скрипта, позволяя атакующему получить несанкционированный доступ к системным файлам.

**File Upload - Null Byte:**

  Допустим веб-приложния просить нас загрусить фото для профиля, и формат файла должен быть .jpeg или .png . Если мы отправим exploit.php то сайт будет давать нам ошибку не то формата файла. Но если мы отправим файл - exploit.php%00.jpeg или exploit.php%00.png то сайт загрузить на эксплойт.

---

# Так что происходить?

Мы просто обошли фильтр, вот как это работает:

  Как мы и сказали нулевой байт в Си это конц строки, и PHP написан непосредственно на Си. И когда мы отправляем файл exploit.php%00.png

  URL видет что наш файл заканчивается на .png или .jpeg и думает что это картинка, но при открытии из назывании файла читается только exploit.php

  Остальное игнорируется, так как после .php символ конца строки, п остальное не относится к этой строке. С точки зрения операционной системы название файла допустимо. Расширение файла PNG, загрузчик по идее должен такой файл пропустить. А функция C должна прервать выполнение после нулевого байта, тогда окажется, что расширение файла PHP.


Пример #1 Уязвимый кода на Perl:

```
  $buffer = $ENV{'QUERY_STRING'};
  $buffer =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack("C", hex($1))/eg;
  $fn = '/home/userx/data/' .$buffer. '.jpg';
  open (FILE,"<$fn");
```

```
 URL: http://www.example.xx/read.pl?file=1.jpg
 Атака: http://www.example.xx/read.pl?file=../../../../etc/passwd%00.jpg
```


Пример #2 PHP

  Сценарий, представленный выше, верен и для PHP. Например, если пользователь запрашивает файл с сервера, к строке будет добавляться расширение файла ".DAT".

```
  $file = $_GET['file'];
  require_once("/var/www/images/$file.dat");
```

  Этот подход кажется безопасным вследствие добавления расширения, но его можно убрать путем добавления нулевого байта в конце URL-адреса.

```
  URL: http://www.example.xx/user.php?file=myprofile.dat
  Атака: http://www.example.xx/user.php?file=../../../etc/passwd%00 
```
