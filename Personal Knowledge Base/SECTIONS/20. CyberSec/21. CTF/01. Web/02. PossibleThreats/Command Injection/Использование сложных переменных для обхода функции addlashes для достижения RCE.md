
> добавляет слеши ( строка $str ) : строка  
> Используйте обратную косую черту для кавычек строк  
> возвращает строку символов, которая имеет обратную косую черту перед определенными символами для запросов к базе данных и т. д. Это одинарные кавычки ('), двойные кавычки ("), обратная косая черта (\) и NUL (символы NULL).

Проще говоря, это экранирование обратной косой черты перед одинарными кавычками, двойными кавычками, обратными косыми чертами и нулевыми символами входящей строки.

#### Сначала посмотрите на код проблемы:

```php
<?php 
highlight_file(__FILE__);
$str=@(string)$_GET['str'];
eval('$str="'.addslashes($str).'";');
```

Заключите здесь аддслеши ($ str) в двойные кавычки, кажется, это не проблема, потому что если мы попытаемся передать их в двойных кавычках, они будут экранированы добавлением обратной косой черты.

#### Посмотрите на разницу между одинарными и двойными кавычками в PHP

###### апостроф:

Контент интерпретироваться не будет (\n будет выводиться не как перевод строки, а напрямую выводится), то есть контент будет согласовываться с входным контентом

```php
$a = 1;
echo 'a is $a';

result： a is $a
```

###### Двойные кавычки:

Содержимое в двойных кавычках будет интерпретироваться, то есть анализируются переменные в содержимом.

```php
$a = 1;
echo "a is $a";

result： a is 1
```

Кроме того, если одинарные кавычки вставлены в двойные кавычки, переменные в одинарных кавычках также будут интерпретированы.

```php
$a = 1;
echo "'a is $a'";

result： 'a is 1'
```

###### Давайте посмотрим на сложные переменные в php.

Из вышесказанного php может разрешать переменные в двойных кавычках.  
Существует два грамматических правила разбора переменных: простое правило и сложное правило.

Сложные правила:

> Любая скалярная переменная со строковым выражением, элементом массива или свойством объекта может использовать этот синтаксис. Просто напишите выражение так, как будто оно находится вне строки, а затем заключите его в фигурные скобки {и}. Так как { не может быть экранирован, $ будет распознан только тогда, когда он стоит рядом с {. Вы можете использовать {$, чтобы выразить {$.

> **примечание:**  
> Функции, методы, статические переменные класса и константы класса доступны только в {$} после PHP 5. Однако доступ к его значению можно получить только как имя переменной в пространстве имен, где определена строка. Использование только фигурных скобок ({}) не может обрабатывать возвращаемое значение функции или метода или значение константы класса и статической переменной класса.

Это описание в руководстве по php.  
Проще говоря, мы хотим использовать переменные в двойных кавычках, тогда как разграничить имена переменных  
Например:

```php
$abc=1;
echo "$abcd";
```

Здесь я хочу вывести 1d, а php будет рассматривать $abcd как переменную, поэтому мы можем использовать {} для разделения нашей переменной

```php
$abc=1;
echo "${abc}d";
```

Другими словами, {} определяет границу имени переменной. Другими словами, "{$ {abc}}" и "$ {abc}" имеют одинаковый эффект.

###### Давайте посмотрим на определение переменных в php.

> Обычно определение переменной должно начинаться с символа подчеркивания или латинской буквы, а имя переменной может содержать только буквы подчеркивания и цифры.

Это обычный способ определения переменных, но PHP также может принимать возвращаемое значение функции в качестве имени переменной.

такой как:

```php
var_dump(${phpinfo()}=123);
var_dump($a=123);

result：int(123) int(123)
```

Шаги именования предыдущего ${phpinfo()}:  
① Сначала выполните phpinfo ()  
② Определите переменную, используя возвращаемое значение phpinfo() в качестве имени переменной.  
③ Значение присвоения переменной равно 123.

Пример показывает суть:

```php
$test = "hello world";
function a(){
$str = 'test';
return $str;
}
echo  "${a()}";

result: hello world
```

Вот, ответы на наши вопросы готовы  
полезная нагрузка:

```php
?str=${eval($_GET[1])}&1=phpinfo();
```
