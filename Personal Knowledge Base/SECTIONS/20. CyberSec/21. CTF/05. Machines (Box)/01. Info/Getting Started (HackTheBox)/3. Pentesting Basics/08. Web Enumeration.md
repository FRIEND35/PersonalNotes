
# Web Enumeration

При выполнении сканирования служб мы часто сталкиваемся с веб-серверами, работающими на портах 80 и 443. На веб-серверах размещаются веб-приложения (иногда более 1), которые часто обеспечивают значительную поверхность атаки и очень ценную цель во время теста на проникновение. Правильное веб-перечисление имеет решающее значение, особенно если организация не предоставляет доступ ко многим службам или эти службы соответствующим образом исправлены.

---
## Gobuster

После обнаружения веб-приложения всегда стоит проверить, сможем ли мы обнаружить на веб-сервере какие-либо скрытые файлы или каталоги, которые не предназначены для публичного доступа. Мы можем использовать такой инструмент, как [ffuf](https://github.com/ffuf/ffuf) или [GoBuster,](https://github.com/OJ/gobuster) для выполнения перечисления этого каталога. Иногда мы обнаруживаем скрытые функции или страницы/каталоги, раскрывающие конфиденциальные данные, которые можно использовать для доступа к веб-приложению или даже для удаленного выполнения кода на самом веб-сервере.

---
#### Directory/File Enumeration

GoBuster — это универсальный инструмент, который позволяет выполнять перебор DNS, vhost и каталогов. Инструмент имеет дополнительные функции, такие как перечисление общедоступных сегментов AWS S3. Для целей этого модуля нас интересуют режимы перебора каталогов (и файлов), заданные с помощью переключателя `dir`. Давайте запустим простое сканирование с помощью `dirb` `common.txt` список слов.

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt

===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.10.121/
[+] Threads:        10
[+] Wordlist:       /usr/share/dirb/wordlists/common.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/12/11 21:47:25 Starting gobuster
===============================================================
/.hta (Status: 403)
/.htpasswd (Status: 403)
/.htaccess (Status: 403)
/index.php (Status: 200)
/server-status (Status: 403)
/wordpress (Status: 301)
===============================================================
2020/12/11 21:47:46 Finished
===============================================================
```

Код состояния HTTP `200`показывает, что запрос ресурса был успешным, а код состояния HTTP 403 указывает, что нам запрещен доступ к ресурсу. Код состояния 301 указывает на то, что нас перенаправляют, что не является случаем сбоя. Стоит ознакомиться с различными кодами состояния HTTP, которые можно найти [здесь](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes) . `Web Requests` Модуль Академии также более подробно описывает коды состояния HTTP.

Сканирование было успешно завершено и выявило установку WordPress по адресу `/wordpress`. WordPress является наиболее часто используемой CMS (системой управления контентом) и имеет огромную потенциальную поверхность атаки. В этом случае посещение `http://10.10.10.121/wordpress` в браузере показывает, что WordPress все еще находится в режиме настройки, что позволит нам получить удаленное выполнение кода (RCE) на сервере.

![[Pasted image 20240804082443.png]]

---
#### DNS Subdomain Enumeration

На поддоменах также могут размещаться важные ресурсы, такие как панели администратора или приложения с дополнительными функциями, которые можно использовать. Мы можем использовать `GoBuster` для перечисления доступных поддоменов данного домена с помощью `dns`флаг для указания режима DNS. Для начала давайте клонируем [репозиторий](https://github.com/danielmiessler/SecLists) SecLists GitHub , который содержит множество полезных списков для фаззинга и эксплуатации:

---
#### Install SecLists

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ git clone https://github.com/danielmiessler/SecLists
```

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ sudo apt install seclists -y
```

Затем добавьте DNS-сервер, например 1.1.1.1, в `/etc/resolv.conf`файл. Мы нацелимся на домен `inlanefreight.com`, веб-сайт вымышленной грузовой и логистической компании.

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt

===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Domain:     inlanefreight.com
[+] Threads:    10
[+] Timeout:    1s
[+] Wordlist:   /usr/share/SecLists/Discovery/DNS/namelist.txt
===============================================================
2020/12/17 23:08:55 Starting gobuster
===============================================================
Found: blog.inlanefreight.com
Found: customer.inlanefreight.com
Found: my.inlanefreight.com
Found: ns1.inlanefreight.com
Found: ns2.inlanefreight.com
Found: ns3.inlanefreight.com
===============================================================
2020/12/17 23:10:34 Finished
===============================================================
```

Это сканирование выявило несколько интересных поддоменов, которые мы могли бы изучить дальше. Модуль [«Атака веб-приложений с помощью Ffuf»](https://academy.hackthebox.com/module/details/54) более подробно описывает веб-перечисление и фаззинг.

---

## Web Enumeration Tips

Давайте рассмотрим несколько дополнительных советов по веб-перечислению, которые помогут комплектовать машины на HTB и в реальном мире.

---
#### Banner Grabbing / Web Server Headers

В последнем разделе мы обсуждали захват баннеров для общих целей. Заголовки веб-сервера дают хорошее представление о том, что размещено на веб-сервере. Они могут выявить конкретную используемую платформу приложения, параметры аутентификации, а также узнать, отсутствуют ли на сервере важные параметры безопасности или он неправильно настроен. Мы можем использовать `cURL` для получения информации заголовка сервера из командной строки. `cURL` — еще одно важное дополнение к нашему набору инструментов для тестирования на проникновение, и знакомство с его многочисленными опциями приветствуется.

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ curl -IL https://www.inlanefreight.com

HTTP/1.1 200 OK
Date: Fri, 18 Dec 2020 22:24:05 GMT
Server: Apache/2.4.29 (Ubuntu)
Link: <https://www.inlanefreight.com/index.php/wp-json/>; rel="https://api.w.org/"
Link: <https://www.inlanefreight.com/>; rel=shortlink
Content-Type: text/html; charset=UTF-8
```

Еще один удобный инструмент — [EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness) , который можно использовать для создания снимков экрана целевых веб-приложений, их отпечатков пальцев и определения возможных учетных данных по умолчанию.

---
#### Whatweb

Мы можем извлечь версию веб-серверов, поддерживающих платформ и приложений с помощью инструмента командной строки. `whatweb`. Эта информация может помочь нам определить используемые технологии и начать поиск потенциальных уязвимостей.

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ whatweb 10.10.10.121

http://10.10.10.121 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], Email[license@php.net], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.121], Title[PHP 7.4.3 - phpinfo()]
```

`Whatweb` это удобный инструмент, содержащий множество функций для автоматизации перечисления веб-приложений в сети.

Веб-перечисление

```shell-session
Uliam@htb[/htb]$ whatweb --no-errors 10.10.10.0/24

http://10.10.10.11 [200 OK] Country[RESERVED][ZZ], HTTPServer[nginx/1.14.1], IP[10.10.10.11], PoweredBy[Red,nginx], Title[Test Page for the Nginx HTTP Server on Red Hat Enterprise Linux], nginx[1.14.1]
http://10.10.10.100 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.100], Title[File Sharing Service]
http://10.10.10.121 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], Email[license@php.net], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.121], Title[PHP 7.4.3 - phpinfo()]
http://10.10.10.247 [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[contact@cross-fit.htb], Frame, HTML5, HTTPServer[OpenBSD httpd], IP[10.10.10.247], JQuery[3.3.1], PHP[7.4.12], Script, Title[Fine Wines], X-Powered-By[PHP/7.4.12], X-UA-Compatible[ie=edge]
```

---
#### Certificates

Сертификаты SSL/TLS — еще один потенциально ценный источник информации, если используется HTTPS. Переход к `https://10.10.10.121/`При просмотре сертификата вы увидите приведенную ниже информацию, включая адрес электронной почты и название компании. Потенциально они могут быть использованы для проведения фишинговой атаки, если это входит в рамки оценки.

![[Pasted image 20240804082519.png]]

---
#### Robots.txt

Обычно веб-сайты содержат `robots.txt`файл, целью которого является указание веб-сканерам поисковых систем, таким как робот Googlebot, к каким ресурсам можно и нельзя получить доступ для индексации. `robots.txt`file может предоставить ценную информацию, такую ​​как расположение личных файлов и страниц администратора. В этом случае мы видим, что `robots.txt` файл содержит две запрещенные записи.

![[Pasted image 20240804082535.png]]

Переход к `http://10.10.10.121/private` в браузере открывается страница входа в систему администратора HTB.

![[Pasted image 20240804082604.png]]

---
#### Source Code

Также стоит проверить исходный код всех веб-страниц, с которыми мы сталкиваемся. Мы можем ударить `[CTRL + U]`чтобы открыть окно исходного кода в браузере. В этом примере показан комментарий разработчика, содержащий учетные данные для тестовой учетной записи, которую можно использовать для входа на веб-сайт.

![[Pasted image 20240804082622.png]]

---
# Questions

Попробуйте применить некоторые из методов веб-перебора, которые вы изучили в этом разделе, на сервере выше и используйте полученную информацию, чтобы получить флаг.
 
Хорошо, ниже — это своего рода живой мыслительный процесс. Я потратил некоторое время, экспериментируя с некоторыми вещами и читая несколько «справочных» страниц, чтобы лучше ознакомиться с вещами. Если хотите, назовите это предварительной игрой, но давайте посмотрим, как это получится «вживую».

```
gobuster dir -u http://94.237.59.199:57361/ -w /usr/share/dirb/wordlists/common.txt    
===============================================================  
Gobuster v3.6  
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)  
===============================================================  
[+] Url:                     http://94.237.59.199:57361/  
[+] Method:                  GET  
[+] Threads:                 10  
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt  
[+] Negative Status codes:   404  
[+] User Agent:              gobuster/3.6  
[+] Timeout:                 10s  
===============================================================  
Starting gobuster in directory enumeration mode  
===============================================================  
/.htaccess            (Status: 403) [Size: 281]  
/.hta                 (Status: 403) [Size: 281]  
/.htpasswd            (Status: 403) [Size: 281]  
/index.php            (Status: 200) [Size: 990]  
/robots.txt           (Status: 200) [Size: 45]  
/server-status        (Status: 403) [Size: 281]  
/wordpress            (Status: 301) [Size: 327] [--> http://94.237.59.199:57361/wordpress/]  
Progress: 4614 / 4615 (99.98%)  
===============================================================  
Finished  
===================================================
```

Я помню, что эти точки (.) — это скрытые каталоги, поэтому давайте поиграем в браузере и посмотрим, что получим… обратите внимание на файл **robots.txt**

![[Pasted image 20240804083758.png]]


Попробуем перейти по странице

```
http://94.237.59.199:57361/admin-login-page.php
```

![[canvas.png]]

Полскольку задача не сложная, то и решение тоже должно быть не сложной. Посмотрим исходный код страницы, может там мы найдем что нибудь.

![[Pasted image 20240804090247.png]]

Как вы можете видеть, я уже ввел учетные данные для этих тестов и…

![[Pasted image 20240804090557.png]]

---