
# Введение 

Shodan — это поисковая система для нахождения самых разнообразных устройств в интернете, таких как: систем и сервисов, которые подключены ко Всемирной Сети. В то время, как Google и другие поисковые системы индексируют только контент веб-сайтов, Shodan способен проиндексировать практически все остальное, начиная из камеры, телевизоры, холодильники, эл. машин, заканчивая медицинское оборудование, светофоры, устройства сканирования номеров, яхты, ветрогенераторы, водоочистные установки, атомные электростанции и многое-многое другое. Другими словами, он способен обнаружить все, что подключено к Интернету (хотя часть из этого и не должна вовсе).


Алгоритм, который лежит в основе работы Shodan по индексированию устройств и сервисов, прост и гениален:

1. Сгенерируйте случайный IPv4-адрес.
2. Сгенерируйте случайный порт для проверки из списка портов, которые Shodan понимает.
3. Проверьте случайный IPv4-адрес на случайном порту и захватите баннер.
4. Вернитесь к первому пункту.

Вот, собственно, и все. Таким образом, постоянно выполняя вышеприведенный алгоритм, Shodan способен найти практически все вещи, подключенные к Интернету, проиндексировать их и сделать возможным поиск по этим вещам.


# Как работает поиск в Shodan?

Элементарная единица данных, которой оперирует Shodan, – это баннер. Баннер представляет собой структурированный текст, описывающий серверный софт, который функционирует на соответствующем IoT. При этом следует понимать, что Shodan ищет
баннеры, а не хосты. Поэтому если на один и тот же IP-адрес завязано сразу несколько сервисов, то в поисковой выдаче будут присутствовать баннеры для каждого из них.

Shodan работает, сканируя интернет и собирая информацию о подключенных к сети устройствах. Процесс работы Shodan можно описать следующим образом:

1. **Сканирование IP-адресов**: Shodan использует специализированные сканеры, которые отправляют запросы на IP-адреса в интернете. Эти запросы могут включать стандартные запросы, такие как запросы HTTP, HTTPS, FTP, Telnet и другие. Shodan также может использовать различные методы сканирования, такие как сканирование портов и протоколов.
    
2. **Сбор информации**: Когда Shodan обнаруживает устройства, он собирает информацию о них, такую как открытые порты, используемые протоколы, баннеры и другие данные, которые могут быть получены из ответов устройств.
    
3. **Индексация**: После сбора информации Shodan индексирует ее в своей базе данных, делая доступной для поиска пользователям.
    
4. **Поиск**: Пользователи могут использовать Shodan для выполнения поиска устройств по различным критериям, таким как тип устройства, страна, наличие уязвимостей и т. д. Shodan предоставляет пользовательский интерфейс и API для выполнения поисковых запросов.
    
5. **Отображение результатов**: Shodan отображает результаты поиска, позволяя пользователям просматривать информацию об устройствах, их характеристики и, при наличии, обнаруженные уязвимости.
    

В целом, Shodan предоставляет инструменты для исследования сетей, обнаружения уязвимостей, мониторинга устройств и других задач, связанных с администрированием и безопасностью сети.

Shodan сканирует весь Интернет и собирает всю общедоступную информацию обо всех устройствах, напрямую подключенных ко Всемирной сети. Shodan использует собственный встроенный сканер портов, а не реализацию на основе Nmap или ZMap. Основную
информацию для анализа Shodan получает из баннеров, с помощью которых сервисы, запущенные на открытых портах, сообщают о себе. Эти баннеры публично объявляют всему Интернету, какие сервисы они представляют и как с ними взаимодействовать. Это может быть информация о программном обеспечении сервера, о том, какие параметры поддерживает сервис, приветственное сообщение или что-то еще, что клиент хотел бы знать, прежде чем начать взаимодействовать с сервером. 

Используя эту информацию, Shodan может сказать вам, например, какой веб-сервер (и версия) наиболее популярен, или сколько анонимных FTP-серверов существует в определенном месте, а также какая марка и модель может быть устройством. Вот так выглядит классический FTP-баннер, который в качестве примера приводится на сайте Shodan:

```
220 kcg.cz FTP server (Version 6.00LS) ready.
```

Эта информация говорит нам о потенциальном имени сервера (kcg.cz), типе FTP-сервера (Solaris ftpd) и его версии (6.00LS). Аналогичный пример баннера для HTTP-сервера выглядит так:

```
HTTP/1.0 200 OK
Date: Tue, 16 Feb 2010 10:03:04 GMT
Server: Apache/1.3.26 (Unix) AuthMySQL/2.20 PHP/4.1.2 mod_gzip/1.3.19.1a
mod_ssl/2.8.9 OpenSSL/0.9.6g
Last-Modified: Wed, 01 Jul 1998 08:51:04 GMT
ETag: "135074-61-3599f878"
Accept-Ranges: bytes
Content-Length: 97
```

Таким образом, хотя Shodan и не индексирует веб-контент, он опрашивает порты 80 (используется по умолчанию в протоколе HTTP) и 443 (используется по умолчанию в протоколе HTTPS), через которые работает подавляющее большинство веб-сайтов во Всемирной сети.
То есть Shodan генерирует случайный адрес и порт и подключается к нему тем самым перехватывает баннер, и сохраняет всё в своем базе данных. Так Shodan сканирует всего всего интернета и анализирует баннеры (баннеры глаыный цель Shodan) и сохраняет в своем базе данных. И так мы поняли что такое Shodan и как он работает, теперь надо разобраться как его использовать.

И так у Shodan-a есть поисковое поле где нужно ввести фильтры, такие как служба, версия, страна, город и так далее. Простой синтаксис будет вот таким: 

```
[что ищем(служба)] [порт:xx] [страну] [город]
```

# Фильтры

Результаты поиска можно фильтровать с помощью следующих конструкций:

```
country: страна, в формате RU, UK, US и т.д., например: nginx country:RU
city: город, например: nginx city:«Moscow» country:RU
os: операционная система, например: microsoft-iis os:«windows 2003»
port: порт в формате 21, 80, 443 и тд, например: proftpd port:21
hostname: позволяет искать с учетом домена, например: nginx hostname:.de
```

К интернету подключено множество устройств с дефолтными логинами и паролями, давайте попробуем что-нибудь найти. Для этого в строке поиска пишем «default+password». Добавим также port:80, чтобы выбрать устройства с www-аутентификацией. В результате мы увидим множество баннеров (http), содержащих искомую фразу, и, как показывает практика, большой процент устройств будут
иметь логин/пароль вида admin/password, admin/pass, и так далее:

![[Pasted image 20240215165817.png]]

## Камеры видеонаблюдения

Если в случае сетевых устройств пользователи в большинстве случаев устанавливают более-менее надежные пароли, то с остальным оборудованием дела обстоят намного хуже. В этом примере мы посмотрим в камеры видеонаблюдения. По работе мне часто приходится
сталкиваться с видеорегистраторами фирмы DVR, некоторые из них имеют выход в сеть.

Пишем в строке поиска: DVR port:80 country:RU city:«Saint Petersburg» И получаем список видеорегистраторов в СПБ, обнаружилось около 200 устройств.

![[Pasted image 20240215165952.png]]

Как можно заметить даже можно указать фирму устройства, а если хотите то иожно и просто называние устройства для удобства.

## Имена пользователей и пароли по умолчанию 

Поисковый запрос "admin+1234" является паролем по умолчанию для большинства маршрутизаторов, поэтому мы будем использовать поисковый запрос" admin + 1234 "для поиска всех маршрутизаторов, которые имеют имя пользователя и пароль по умолчанию. 

**Используемый запрос:**

```
admin+1234 
```

**Пароли по умолчанию**

Наконец, мы будем использовать shodan для поиска веб-сайтов, у которых есть «пароли по умолчанию» в качестве ключевого слова в их баннерах. Баннер, скорее всего, раскроет пароли по умолчанию. Мы будем использовать фильтр "default password"

**Используемый запрос:**

```
default-passwords
```

Самый простой вариант поиска — это ввести название или производителя нужного нам устройства. Например если мы введем tp-link то справа увидим найденные устройства и их баннеры, а слева некоторые статистические данные, по которым также можно отфильтровать устройства. Также нужно помнить, что это не Google, а потому запрос для поиска обрабатывается как точное выражение, без всяких вариаций. Для примера найдем вебкамеры, в Москве, которые используют порт 8080:

```
webcam country:RU city:Moscow port:8080
```

Теперь, для разнообразия, давай найдем, например, сервера nginx, под управлением операционной системы Linux, с открытым портом 5000: 

```
nginx os:linux port:5000
```

Случаи применения Вы можете использовать кнопку «Исследовать» на главном сайте Shodan, чтобы просмотреть общие поисковые запросы и результаты, которые подсвечиваются. С помощью Shodan можно найти различные типы устройств, подключенных к интернету. Вот лишь несколько примеров:

1. **Серверы**: Веб-серверы, FTP-серверы, базы данных и другие серверные устройства могут быть обнаружены с помощью Shodan.
    
2. **Маршрутизаторы и коммутаторы**: Сетевое оборудование, такое как маршрутизаторы, коммутаторы и файерволы, часто доступно через интернет и может быть найдено с помощью Shodan.
    
3. **Веб-камеры и видеорегистраторы**: Многие веб-камеры и видеорегистраторы подключаются к интернету для удаленного просмотра видео. Shodan может обнаружить такие устройства и предоставить доступ к их видеопотокам.
    
4. **Умные устройства (IoT)**: Умные устройства, такие как умные телевизоры, умные домашние устройства, умные замки и термостаты, также могут быть обнаружены с помощью Shodan.
    
5. **Промышленное оборудование**: Промышленные контроллеры, системы автоматизации, датчики и другое оборудование, используемое в промышленности, могут быть обнаружены через Shodan.
    
6. **Системы управления зданием (Building Management Systems, BMS)**: BMS, управляющие системы, используемые для контроля и мониторинга зданий, также могут быть найдены с помощью Shodan.

Возможно, что светофоры не так часто подключены к интернету напрямую, как многие другие устройства. Традиционные светофоры обычно управляются локальными системами, которые могут быть связаны с центральной системой управления, но не обязательно подключены к интернету. Кроме того, светофоры могут быть частью инфраструктуры города или региона, и доступ к ним может быть ограничен из соображений безопасности или из-за ограничений доступа к сети. Это может делать их менее подходящими для обнаружения с помощью общедоступных средств сканирования, таких как Shodan.

В некоторых случаях, когда светофоры используются в «умных» системах управления транспортной инфраструктурой, они могут быть подключены к сети, но это не всегда типичная ситуация для всех светофоров. В общем, большинство светофоров работает в закрытых локальных сетях, что делает их недоступными для поиска через публичные средства, такие как Shodan.

Это лишь небольшой перечень устройств, которые можно найти с помощью Shodan. Фактически, Shodan может обнаруживать практически любое устройство, которое подключено к интернету и отвечает на запросы, в зависимости от того, какие протоколы и порты оно использует.


**Это наиболее юзаемые фильтры:**

```
country: — покажет данные только по выбранной стране, например country:RU
city: — покажет данные только по выбранному городу, например city:Moskow
os: — найти определенную операционную систему, например os:linux
geo: — поиск по геопозиции, нужно указать координаты, например geo:»45.0746,39.0587′′
port: — покажет результаты только по выбранному порту, например port:22
hostname: — будет искать только в определенной доменной зоне, например hostname:.ru
net: — поиск в заданном сетевом диапазоне, например net:190.73.40.50/24
product: — поиск по названию программы отдающей баннер, например product:openssh
```

Имя хоста: найти устройства, соответствующие имени хоста:

```
hostname: "google"
net: поиск по IP-адресу
net: ”216.219.143.0/24 ′′
```

Фильтров правда очень много, но это только самые часто используемые из них. И так давайте проведём итог как использовать Shodan:
1) Сначало напишите то что вы ищите – служба, серверб, названия продукта
Хоть что небудь чтоб Shodan понял то что вы пытаетесь найти.
2) Резултатов будет довольно много, и поэтому вы можете использовать фильтры
Такие как страна, город, координаты, порт и т.д. Вы даже можете использовать такие фильтры: default+password, admin+123 и так
Далее. В результате вы получите службы слжубы у которых дэфлтные пароли, А admin+123 само мобой говорить что пусть логином будет – admin, а пароль – 123.

Shodan предоставляет множество фильтров, которые позволяют уточнять результаты поиска в соответствии с вашими потребностями. Вот несколько основных фильтров и примеры их использования:

1. **country**: Фильтр по стране. Позволяет ограничить результаты поиска устройств, находящихся в определенной стране. Пример: `country:US` (ищет устройства, находящиеся в Соединенных Штатах)
    
2. **port**: Фильтр по номеру порта. Позволяет искать устройства, имеющие открытые определенные порты. Пример: `port:22` (ищет устройства с открытым портом SSH)
    
3. **hostname**: Фильтр по имени хоста. Позволяет искать устройства с определенным именем хоста. Пример: `hostname:example.com` (ищет устройства с именем хоста example.com)
    
4. **net**: Фильтр по диапазону IP-адресов. Позволяет искать устройства в определенном диапазоне IP-адресов. Пример: `net:202.54.1.0/24` (ищет устройства в диапазоне IP-адресов от 202.54.1.0 до 202.54.1.255)
    
5. **after/before**: Фильтр по дате последнего обновления. Позволяет искать устройства, обновленные после или до определенной даты. Пример: `after:2023-01-01` (ищет устройства, обновленные после 1 января 2023 года)
    
6. **product**: Фильтр по продукту или сервису. Позволяет искать устройства с определенным программным обеспечением или сервисами. Пример: `product:Apache` (ищет устройства, использующие веб-сервер Apache)
    
7. **os**: Фильтр по операционной системе. Позволяет искать устройства с определенной операционной системой. Пример: `os:Windows` (ищет устройства с операционной системой Windows)
    

Это лишь несколько примеров фильтров, которые можно использовать с Shodan. Вы можете комбинировать эти фильтры для создания более точных запросов и настройки поисковых результатов под ваши нужды.