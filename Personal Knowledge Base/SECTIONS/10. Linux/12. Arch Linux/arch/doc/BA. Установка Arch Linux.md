
Данное руководство состоит из кратко описанных шагов, которым рекомендуется следовать в указанном порядке. Более подробные инструкции приведены в соответствующих статьях [ArchWiki](https://wiki.archlinux.org/title/ArchWiki:About_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "ArchWiki:About (Русский)") и на [страницах справочных руководств (man)](https://wiki.archlinux.org/title/Man_page_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Man page (Русский)") различных программ. Ссылки и на то, и на другое присутствуют в этом руководстве. Также вы можете получить помощь в [IRC-канале](https://wiki.archlinux.org/title/IRC_channel_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "IRC channel (Русский)"), на [англоязычном форуме](https://bbs.archlinux.org/) или в [русскоязычных сообществах](https://wiki.archlinux.org/title/International_communities#Russian "International communities") Arch Linux.

Arch Linux способен работать на любой [x86_64](https://en.wikipedia.org/wiki/ru:x86-64 "wikipedia:ru:x86-64")-совместимой машине, имеющей хотя бы 512 МиБ ОЗУ, однако для загрузки live-системы нужно больше памяти.[[1]](https://lists.archlinux.org/archives/list/arch-releng@lists.archlinux.org/message/D5HSGOFTPGYI6IZUEB3ZNAX4D3F3ID37/) Базовая установка занимает менее 2 ГиБ места на диске. Так как во время установки скачиваются пакеты из удалённого репозитория, необходимо работающее интернет-соединение.

#### Этапы установки Arch Linux

Установка Arch Linux включает несколько этапов:

1. [[#### Подготовка к установке|1. Подготовка установочного носителя: Загрузите официальный ISO-образ Arch Linux с веб-сайта проекта и создайте загрузочный носитель, например, с помощью записи образа на USB-накопитель.]]

2. [[#### Загрузка live-окружения|Загрузка и запуск: Подключите загрузочный носитель к компьютеру и загрузитесь с него. Вы окажетесь в командной строке Arch Linux.]]

3. [[#### Разметка дисков|Создание разделов диска: Используйте инструменты для разделения жесткого диска или SSD-накопителя на нужные разделы (например, GPT или MBR) и файловую систему (например, ext4).]]

4. [[#### Форматирование разделов|Форматирование разделов: Возьмите каждый раздел, который вы создали, и отформатируйте его в соответствующую файловую систему, например, с помощью команды mkfs.ext4 для форматирования в ext4.]]

5. [[#### Монтирование разделов|Монтирование разделов: Создайте каталоги монтирования для каждого раздела и примонтируйте их, используя команду mount, например, mount /dev/sda1 /mnt.]]

6. [[###### Как установить базовую систему Arch Linux|Установка базовой системы: Используйте команду pacstrap для установки базовых пакетов Arch Linux на выбранное место монтирования, например, pacstrap /mnt base.]]

7. [[#### Настройка системы|Настройка системы: Сгенерируйте файл fstab с помощью команды genfstab -U /mnt >> /mnt/etc/fstab и войдите в установленную систему с помощью команды arch-chroot /mnt. Затем настройте часовой пояс, локализацию, сеть, имя компьютера и другие параметры.]]

8. [[##### Загрузчик|Установка загрузчика: Установите и настройте загрузчик, такой как GRUB или systemd-boot, чтобы была возможность загрузить Arch Linux при следующей перезагрузке.]]

9. [[#### Настройки пользовательского окружения|Настройка пользовательского окружения: Установите необходимые пакеты, создайте пользователей и настройте доступ к сети, аудио, графике и другим системным компонентам по вашему выбору.]]

10. [[##### Завершение установки|Завершение установки: После завершения всех необходимых настроек вы можете выйти из chroot-среды, отмонтировать разделы и перезагрузить систему.]]

Обратите внимание, что это общая последовательность этапов установки, и некоторые шаги могут отличаться в зависимости от конкретных требований или предпочтений пользователя.
#### Подготовка к установке

##### Проверка подписи

Рекомендуется проверять подпись образа перед его использованием, особенно когда он был загружен с _зеркала HTTP_, где загрузки обычно подвержены перехвату для [подмены образа на вредоносный](https://www2.cs.arizona.edu/stork/packagemanagersecurity/attacks-on-package-managers.html).

На системах с установленным [GnuPG](https://wiki.archlinux.org/title/GnuPG_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "GnuPG (Русский)") вы можете сделать это, скачав _ISO PGP signature_ (ссылка на него есть [на странице загрузок в разделе _Checksums_](https://archlinux.org/download/#checksums)) в каталог с образом и выполнив [команду](https://wiki.archlinux.org/title/GnuPG_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0_%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B8 "GnuPG (Русский)"):

$ gpg --keyserver-options auto-key-retrieve --verify archlinux-_версия_-x86_64.iso.sig

Также можно проверить подпись из установленного Arch Linux:

```
$ pacman-key -v archlinux-_версия_-x86_64.iso.sig
```

>**Примечание:**
>
> 1. Самой подписью можно манипулировать, если загрузить её с зеркала, а не с [archlinux.org](https://archlinux.org/download/), как указано выше. В этом случае убедитесь, что открытый ключ, который используется для декодирования подписи, подписан другим надёжным ключом. Команда `gpg` выведет отпечаток (fingerprint) открытого ключа.
> 
> 2.  Ещё один метод проверки подлинности подписи — убедиться, что отпечаток открытого ключа идентичен отпечатку ключа [разработчиков Arch Linux](https://archlinux.org/people/developers/), которые подписали ISO-образ. Для получения дополнительной информации о процессе проверки подлинности открытых ключей смотрите статью [Wikipedia:ru:Криптосистема с открытым ключом](https://en.wikipedia.org/wiki/ru:%D0%9A%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D1%81_%D0%BE%D1%82%D0%BA%D1%80%D1%8B%D1%82%D1%8B%D0%BC_%D0%BA%D0%BB%D1%8E%D1%87%D0%BE%D0%BC "wikipedia:ru:Криптосистема с открытым ключом").

##### Подготовка установочного носителя

Загрузить установочный образ на машине, на которой будет проводиться установка, можно с помощью [USB-накопителя](https://wiki.archlinux.org/title/USB_flash_installation_medium_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "USB flash installation medium (Русский)"), [оптического диска](https://wiki.archlinux.org/title/Optical_disc_drive#Burning "Optical disc drive") или сети (при помощи [PXE](https://wiki.archlinux.org/title/Preboot_Execution_Environment_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Preboot Execution Environment (Русский)")) — инструкции для подготовки установочного носителя описаны в соответствующих статьях. Сначала вам нужно:

1. Скачать arch linux c официального сайта;

2. Создать загрузочную флэшку (LiveUSB/CD). Это можно сделать с п.м. Etcher, Rufus, Ventoy или любая другая программа для создание загрузочной флэшки.

3. Загрузить Live-систему.

#### Загрузка live-окружения


Перейдите на [страницу загрузок](https://archlinux.org/download/) и, в зависимости от желаемого способа загрузки live-системы, скачайте ISO-файл или netboot-образ, а также соответствующую подпись [GnuPG](https://wiki.archlinux.org/title/GnuPG_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "GnuPG (Русский)").

**Примечание:** Установочные образы Arch Linux не поддерживают Secure Boot, в связи с чем необходимо [отключить](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Disabling_Secure_Boot "Unified Extensible Firmware Interface/Secure Boot") данную функцию перед загрузкой. Однако при желании возможно настроить [Secure Boot](https://wiki.archlinux.org/title/Secure_Boot "Secure Boot") после завершения установки Arch Linux.

1. Загрузите компьютер с установочного носителя с Arch Linux. Для выбора загрузочного устройства обычно при включении компьютера нажимается специальная клавиша (иногда она указывается на заставке) во время фазы [POST](https://en.wikipedia.org/wiki/ru:POST_(%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5) "wikipedia:ru:POST (аппаратное обеспечение)"). Обратитесь к руководству вашей материнской платы для получения более подробных инструкций.
2. Когда появится меню установочного носителя, выберите _Arch Linux install medium_ и нажмите `Enter` для входа в установочное окружение.
    
    **Совет:**
    
    - Установочный образ использует [GRUB](https://wiki.archlinux.org/title/GRUB_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "GRUB (Русский)") при загрузке в UEFI-режиме и [syslinux](https://wiki.archlinux.org/title/Syslinux_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Syslinux (Русский)") в BIOS-режиме. Используйте клавишу `e` или `Tab` для редактирования [параметров загрузки](https://wiki.archlinux.org/title/Kernel_parameters_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0 "Kernel parameters (Русский)"). Список доступных параметров описан в [README.bootparams](https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio-archiso/blob/master/docs/README.bootparams).
    - Распространённый пример ручной установки параметра загрузки — размер шрифта. Для улучшения читабельности на экране HiDPI (если он не распознался автоматически) может помочь добавление параметра `fbcon=font:TER16x32`. Смотрите раздел [HiDPI (Русский)#Консоль Linux (tty)](https://wiki.archlinux.org/title/HiDPI_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9A%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D1%8C_Linux_(tty) "HiDPI (Русский)") для более подробной информации.
    
3. После загрузки вы попадёте в первую [виртуальную консоль](https://en.wikipedia.org/wiki/ru:Linux-%D0%BA%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D1%8C "wikipedia:ru:Linux-консоль") как пользователь root и увидите приглашение командной оболочки [Zsh](https://wiki.archlinux.org/title/Zsh_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Zsh (Русский)").

Чтобы переключиться на другую виртуальную консоль в процессе установки (например, для просмотра этого руководства в [Lynx](https://lynx.invisible-island.net/lynx_help/Lynx_users_guide.html)), используйте [горячие клавиши](https://wiki.archlinux.org/title/%D0%93%D0%BE%D1%80%D1%8F%D1%87%D0%B8%D0%B5_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B8 "Горячие клавиши") `Alt+_стрелка_`. Для [редактирования](https://wiki.archlinux.org/title/Help:Reading_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C "Help:Reading (Русский)") файлов доступны программы [mcedit(1)](https://man.archlinux.org/man/mcedit.1), [nano](https://wiki.archlinux.org/title/Nano_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5 "Nano (Русский)") и [vim](https://wiki.archlinux.org/title/Vim_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5 "Vim (Русский)"). Список пакетов, присутствующих в установочном образе, доступен на странице [pkglist.x86_64.txt](https://geo.mirror.pkgbuild.com/iso/latest/arch/pkglist.x86_64.txt).

Нужно загрузиться с флешки. Для этого при запуске компьютера много раз нажимайте кнопку **Esc** (на некоторых системах **Delete**), если появится подобное меню, то выберите флешку:

![[Pasted image 20230813212034.png]]

Это меню загрузки (Boot menu). С его п.м. мы указываем что нужно грузить. Либо перейдите в BIOS и там установите на первое место ваш носитель. Если у вас современный UEFI BIOS, то аналогично необходимо найти раздел **Загрузка** или в **Boot Priority** выбрать вашу флешку.

**Примечание**: в настройках BIOS Secure boot (Безопасная загрузка) и Fast boot (Быстрая загрузка) должны быть отключены.

**Примечание:** Установочные образы Arch Linux не поддерживают Secure Boot, в связи с чем необходимо [отключить](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Disabling_Secure_Boot "Unified Extensible Firmware Interface/Secure Boot") данную функцию перед загрузкой. Однако при желании возможно настроить [Secure Boot](https://wiki.archlinux.org/title/Secure_Boot "Secure Boot") после завершения установки Arch Linux.

1. Загрузите компьютер с установочного носителя с Arch Linux. Для выбора загрузочного устройства обычно при включении компьютера нажимается специальная клавиша (иногда она указывается на заставке) во время фазы [POST](https://en.wikipedia.org/wiki/ru:POST_(%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5) "wikipedia:ru:POST (аппаратное обеспечение)"). Обратитесь к руководству вашей материнской платы для получения более подробных инструкций.
2. Когда появится меню установочного носителя, выберите _Arch Linux install medium_ и нажмите `Enter` для входа в установочное окружение.
    
    **Совет:**
    
    - Установочный образ использует [GRUB](https://wiki.archlinux.org/title/GRUB_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "GRUB (Русский)") при загрузке в UEFI-режиме и [syslinux](https://wiki.archlinux.org/title/Syslinux_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Syslinux (Русский)") в BIOS-режиме. Используйте клавишу `e` или `Tab` для редактирования [параметров загрузки](https://wiki.archlinux.org/title/Kernel_parameters_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0 "Kernel parameters (Русский)"). Список доступных параметров описан в [README.bootparams](https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio-archiso/blob/master/docs/README.bootparams).
    - Распространённый пример ручной установки параметра загрузки — размер шрифта. Для улучшения читабельности на экране HiDPI (если он не распознался автоматически) может помочь добавление параметра `fbcon=font:TER16x32`. Смотрите раздел [HiDPI (Русский)#Консоль Linux (tty)](https://wiki.archlinux.org/title/HiDPI_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9A%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D1%8C_Linux_(tty) "HiDPI (Русский)") для более подробной информации.
    
3. После загрузки вы попадёте в первую [виртуальную консоль](https://en.wikipedia.org/wiki/ru:Linux-%D0%BA%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D1%8C "wikipedia:ru:Linux-консоль") как пользователь root и увидите приглашение командной оболочки [Zsh](https://wiki.archlinux.org/title/Zsh_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Zsh (Русский)").

Чтобы переключиться на другую виртуальную консоль в процессе установки (например, для просмотра этого руководства в [Lynx](https://lynx.invisible-island.net/lynx_help/Lynx_users_guide.html)), используйте [горячие клавиши](https://wiki.archlinux.org/title/%D0%93%D0%BE%D1%80%D1%8F%D1%87%D0%B8%D0%B5_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B8 "Горячие клавиши") `Alt+_стрелка_`. Для [редактирования](https://wiki.archlinux.org/title/Help:Reading_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C "Help:Reading (Русский)") файлов доступны программы [mcedit(1)](https://man.archlinux.org/man/mcedit.1), [nano](https://wiki.archlinux.org/title/Nano_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5 "Nano (Русский)") и [vim](https://wiki.archlinux.org/title/Vim_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5 "Vim (Русский)"). Список пакетов, присутствующих в установочном образе, доступен на странице [pkglist.x86_64.txt](https://geo.mirror.pkgbuild.com/iso/latest/arch/pkglist.x86_64.txt).

![[Pasted image 20230813211758.png]]

И… добро пожаловать в Arch Linux!

![[Pasted image 20230813212306.png]]
#### Перед установкой

Вы попадете в Live-систему ArchLinux. Загрузится виртуальная консоль (терминал), в котором вы будете вводить команды. Во время установки, вы работаете от имени суперпользователя (root).

##### Установка раскладки клавиатуры и шрифта

По умолчанию используется [раскладка консоли](https://wiki.archlinux.org/title/%D0%A0%D0%B0%D1%81%D0%BA%D0%BB%D0%B0%D0%B4%D0%BA%D0%B0_%D0%BA%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D0%B8 "Раскладка консоли") [US](https://en.wikipedia.org/wiki/File:KB_United_States-NoAltGr.svg "w:File:KB United States-NoAltGr.svg"). Посмотреть список доступных раскладок можно с помощью команды:

```
# ls /usr/share/kbd/keymaps/**/*.map.gz
```

Чтобы выбрать раскладку, передайте имя соответствующего файла команде [loadkeys(1)](https://man.archlinux.org/man/loadkeys.1), не указывая полного пути и расширения. Например, чтобы выбрать [русскую](https://en.wikipedia.org/wiki/File:KB_Russian.svg "wikipedia:File:KB Russian.svg") раскладку, выполните команду:

```
# loadkeys ru
```

Используйте `Ctrl+Shift` для переключения между английской и русской раскладками.

Для корректного отображения кириллицы нужно выбрать подходящий консольный шрифт. [Консольные шрифты](https://wiki.archlinux.org/title/Linux_console_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A8%D1%80%D0%B8%D1%84%D1%82%D1%8B "Linux console (Русский)") расположены в каталоге `/usr/share/kbd/consolefonts/` и могут быть выбраны аналогичным способом с помощью команды [setfont(8)](https://man.archlinux.org/man/setfont.8).

Например, для загрузки шрифта стандартного размера с русскими буквами выполните:

```
# setfont cyr-sun16
```

Таким образом мы загрузим шрифт с поддержкой русского языка:

Для [экрана HiDPI](https://wiki.archlinux.org/title/HiDPI_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9A%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D1%8C_Linux_(tty) "HiDPI (Русский)") можно выбрать один из самых больших доступных шрифтов с русскими буквами:

```
# setfont ter-c32b
```

##### Проверка режима загрузки

Чтобы проверить режим загрузки, просмотрите содержимое каталога [efivars](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5_UEFI "Unified Extensible Firmware Interface (Русский)"):

```
# ls /sys/firmware/efi/efivars
```

Если содержимое отображается без каких-либо ошибок, система загружена в режиме UEFI. Если же такого каталога не существует, возможно, система загружена в режиме [BIOS](https://en.wikipedia.org/wiki/ru:BIOS "wikipedia:ru:BIOS") (или [CSM](https://en.wikipedia.org/wiki/Compatibility_Support_Module "wikipedia:Compatibility Support Module")). Если система загрузилась не в том режиме, который вам нужен, обратитесь к руководству пользователя вашей материнской платы. Для BIOS это проверка не требуется.
##### Подключение к Интернету

Необходимо настроить интернет, поскольку всё остальное бессмысленно, если отсутствует интернет подключение.
###### Ethernet

Если у вашего компьютера проводное интернет подключение, то всё достаточно просто – Arch сам попытается настроить Интернет-подключение и получить IP адрес, если роутер поддерживает DHCP.

При установке я использовал проводное подключение по Ethernet. В моем случае установщик автоматически запустил службу dhcpcd и интернет заработал.

В любом случае, проверьте подключение к сети пингом:

```
# ping google.com
```

Если на роутере отключена эта служба, то вам нужно вручную настроить ваш сетевой интерфейс. Пример как это сделать [здесь](https://blackarch.ru/?p=483) (в этой инструкции я настраивал подключение, когда устанавливал на VPS)
###### WI-FI

Допустим, у меня нет проводного соединения, поэтому я покажу как подключиться к Wi-Fi в командной строке.

Вместе с установщиком поставляется программа-помощник для подключения к Wi-Fi, вы можете вызвать её следующей командой и следовать инструкциям на экране:

```
# wifi-menu
```

Или:

```
# wifi-menu <имя_интерфейса>
```

Если она сработает, то пропустите описанный ниже способ подключения. У с wifi-menu все попытки подключения заканчиваются неудачей, поэтому я использую свой метод.

Начинаем с того, что смотрим имя беспроводного сетевого интерфейса:

```
# ip a
```

![[Pasted image 20230813213631.png]]

Или же:

```
# iw dev
```

![[Pasted image 20230814043152.png]]

Видно, что имя моего беспроводного интерфейса **wlo1**. Прежде чем подключиться к какой-нибудь Wi-Fi сети, нам нужно узнать, какие точки доступа вообще доступны. Для этого мы просканируем Wi-Fi сети в командной строке.

Поскольку никакого NetworkManager пока нет, то нужно начать с активации сетевого интерфейса:

```
# ip link set wlo1 up
```

Вместо **wlo1** здесь и во всех последующих командах вставьте имя вашего беспроводного адаптера.

Сканируем сети:

```
# iw dev wlo1 scan | grep SSID
```

![[Pasted image 20230814043345.png]]

В результате выполнения этой команды будут выведены имена беспроводных сетей. У меня две сети с одинаковым именем MiAl поскольку роутер работает на двух частотах и обе сети называются одинаково.

Нам нужно сформировать конфигурационный файл. Делается это командой:

```
# wpa_passphrase название_ТД пароль > конфигурационный_файл
```

К примеру, для ТД **MiAl** пароль **здесь_пароль_wifi** и конфигурационный файл я хочу назвать **wpa_MiAl.conf**, тогда команда имеет следующий вид:

```
# wpa_passphrase MiAl здесь_пароль_wifi > wpa_MiAl.conf
```

Подключаемся к точке доступа:

```
# wpa_supplicant -B -i wlo1 -c wpa_MiAl.conf
```

В предыдущей команде укажите свой беспроводной интерфейс (wlo1) и свой файл с настройками (wpa_MiAl.conf).

Для получения автоматических настроек по протоколу DHCP (присвоенный IP адрес, IP адрес шлюза и IP адреса DNS серверов) выполните команду:

```
# dhclient wlo1 
```

Вы так же можете подключиться к Wi-Fi в интерактивном режиме с помощью этой полезной утилиты под названием iwctl. Просто введите эту команду и следуйте инструкциям на экране:

```
# iwctl
```

Далее вы можете перечислить все ваши беспроводные интерфейсы/устройства, подключенные с помощью команды:

```
# device list
```

Вам нужно выбрать предпочтительный.

После того, как вы выберете беспроводной интерфейс, выполните сканирование доступной сети с помощью приведенной ниже команды:

```
# station wlan0 scan
```

Пока он сканирует сеть, вы еще не видите имена сетей. Итак, чтобы увидеть доступные подключения, вы можете ввести:

```
# station wlan0 get-networks
```

Среди перечисленных сетей вы можете подключиться к целевому Wi-Fi с помощью команды:

```
# station wlan0 connect "Name of Network/WiFi"
```

Если он защищен паролем, вам будет предложено ввести его, введите учетные данные, и вы должны быть подключены к нему.

Выйдите из приглашения настройки сети с помощью **Ctrl + D**.

Теперь мы подключены к сети, но чтобы убедиться, вы можете проверить, можете ли вы использовать Интернет, используя команду ping:

```
# ping google.com
```

Если вы получаете байты в ответ, вы подключены. Используйте **клавиши CTRL+**C, чтобы остановить ответ ping.

Если всё сильно упростить, то для настройки сетевого соединения в live-окружении выполните следующие действия:

- Убедитесь, что ваш [сетевой интерфейс](https://wiki.archlinux.org/title/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D1%81%D0%B5%D1%82%D0%B8#%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D1%8B "Настройка сети") обнаружен и включён, например, с помощью [ip-link(8)](https://man.archlinux.org/man/ip-link.8):
    
```
# ip link
```
    
- Если планируется использовать Wi-Fi или WWAN, убедитесь, что беспроводная карта не заблокирована с помощью [rfkill](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)/Wireless_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9F%D1%80%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D0%B5%D1%80%D0%B5%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F_Rfkill "Network configuration (Русский)/Wireless (Русский)").
- Подключитесь к сети:
    - Ethernet: подключите кабель.
    - Wi-Fi: подключитесь к беспроводной сети с помощью [iwctl](https://wiki.archlinux.org/title/Iwd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#iwctl "Iwd (Русский)").
    - Мобильный широкополосный модем: подключитесь к мобильной сети с помощью утилиты [mmcli](https://wiki.archlinux.org/title/Mmcli "Mmcli").
- Настройте сетевые соединения:
    - [DHCP](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#DHCP "Network configuration (Русский)"): установка динамического IP-адреса и адреса DNS-сервера (при помощи [systemd-networkd](https://wiki.archlinux.org/title/Systemd-networkd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Systemd-networkd (Русский)") и [systemd-resolved](https://wiki.archlinux.org/title/Systemd-resolved_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Systemd-resolved (Русский)")) должна срабатывать автоматически для проводных и беспроводных сетевых интерфейсов.
    - Статический IP: смотрите [Настройка сети#Статический IP-адрес](https://wiki.archlinux.org/title/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D1%81%D0%B5%D1%82%D0%B8#%D0%A1%D1%82%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81 "Настройка сети").
- Соединение можно проверить с помощью утилиты [ping](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#Ping "Network configuration (Русский)"):
    
```
# ping archlinux.org
```
    

**Примечание:** Установочный образ включает в себя преднастроенные и активированные службы [systemd-networkd](https://wiki.archlinux.org/title/Systemd-networkd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Systemd-networkd (Русский)"), [systemd-resolved](https://wiki.archlinux.org/title/Systemd-resolved_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Systemd-resolved (Русский)"), [iwd](https://wiki.archlinux.org/title/Iwd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Iwd (Русский)") и [ModemManager](https://wiki.archlinux.org/title/ModemManager "ModemManager"). Если вы хотите использовать их в устанавливаемой системе, нужно будет установить, настроить и активировать их вручную.

##### Синхронизация системных часов

В live-окружении по умолчанию включен [systemd-timesyncd](https://wiki.archlinux.org/title/Systemd-timesyncd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Systemd-timesyncd (Русский)"), который выполнит синхронизацию времени автоматически после подключения интернета.

Чтобы удостовериться, что время задано правильно, используйте [timedatectl(1)](https://man.archlinux.org/man/timedatectl.1):

```
# timedatectl
```

Включите синхронизацию времени через интернет:

```
# timedatectl set-ntp true
```

Теперь необходимо установить часовой пояс. Для просмотра доступных часовых поясов воспользуйтесь командой:

```
# timedatectl list-timezones
```

Можно, например, вывести доступные часовые зоны для Европы:

```
# timedatectl list-timezones | grep Europe
```

Установите ваш часовой пояс:

```
# timedatectl set-timezone Europe/Moscow
```

Для проверки времени используется команда:

```
# timedatectl status
```

Убедитесь, что в поле «_Local time_» указано верное время.

#### Разметка дисков

Разметка диска - это процесс, при котором физический носитель данных, такой как жесткий диск или SSD (твердотельный накопитель), структурируется и подготавливается для хранения файловой системы и данных. Разметка диска включает в себя создание разделов (partitions) на диске и установку файловой системы на каждом разделе. Разделы могут быть использованы для организации данных, управления доступом и улучшения эффективности хранения информации.

Когда запущенная система распознает накопители, они становятся доступны как [блочные устройства](https://wiki.archlinux.org/title/%D0%91%D0%BB%D0%BE%D1%87%D0%BD%D0%BE%D0%B5_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%BE "Блочное устройство"), например, `/dev/sda`, `/dev/nvme0n1` или `/dev/mmcblk0`. Чтобы посмотреть их список, используйте [lsblk](https://wiki.archlinux.org/title/Lsblk_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Lsblk (Русский)") или _fdisk_.

```
# fdisk -l
```

Результаты, оканчивающиеся на `rom`, `loop` и `airoot`, можно игнорировать.

**Совет:** Перед разметкой NVMe-накопителей и жёстких дисков с расширенным форматом (Advanced Format) проверьте, что они используют [оптимальный логический размер сектора](https://wiki.archlinux.org/title/Advanced_Format_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Advanced Format (Русский)").

На выбранном накопителе **должны присутствовать** следующие [разделы](https://wiki.archlinux.org/title/Partitioning_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Partitioning (Русский)"):

- Раздел для [корневого каталога](https://en.wikipedia.org/wiki/ru:%D0%9A%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3_(%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0)#.D0.9A.D0.BE.D1.80.D0.BD.D0.B5.D0.B2.D0.BE.D0.B9_.D0.BA.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3 "wikipedia:ru:Каталог (файловая система)") `/`.
- Для загрузки в режиме [UEFI](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Unified Extensible Firmware Interface (Русский)") также необходим [системный раздел EFI](https://wiki.archlinux.org/title/%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%BD%D1%8B%D0%B9_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB_EFI "Системный раздел EFI").

Если вы хотите создать составное блочное устройство для [LVM](https://wiki.archlinux.org/title/LVM_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "LVM (Русский)"), [шифрования системы](https://wiki.archlinux.org/title/Dm-crypt_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Dm-crypt (Русский)") или [RAID](https://wiki.archlinux.org/title/RAID_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "RAID (Русский)"), сделайте это сейчас.

Для изменения таблицы разделов используйте [[Графический сервер]],  [fdisk](https://wiki.archlinux.org/title/Fdisk_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Fdisk (Русский)") или [parted](https://wiki.archlinux.org/title/Parted_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Parted (Русский)"). Например:

```
# fdisk /dev/диск_для_разметки
```

**Примечание:**

- Если диск не отображается, [убедитесь, что контроллер диска не находится в режиме RAID](https://wiki.archlinux.org/title/Partitioning_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%94%D0%B8%D1%81%D0%BA%D0%B8_%D0%BD%D0%B5_%D0%B2%D0%B8%D0%B4%D0%BD%D1%8B,_%D0%BA%D0%BE%D0%B3%D0%B4%D0%B0_%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD_%D0%B2%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_RAID "Partitioning (Русский)").
- Если диск, с которого планируется загрузка системы, [уже содержит системный раздел EFI](https://wiki.archlinux.org/title/EFI_system_partition_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0_%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B0 "EFI system partition (Русский)") — не создавайте новый раздел, а используйте существующий.
- [Подкачка](https://wiki.archlinux.org/title/Swap_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Swap (Русский)") может быть размещена в [файле подкачки](https://wiki.archlinux.org/title/Swap_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A4%D0%B0%D0%B9%D0%BB_%D0%BF%D0%BE%D0%B4%D0%BA%D0%B0%D1%87%D0%BA%D0%B8 "Swap (Русский)"), если файловая система поддерживает его.

##### Примеры схем

###### UEFI с GPT

|Точка монтирования|Раздел|[Тип раздела](https://en.wikipedia.org/wiki/ru:%D0%A2%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%BE%D0%B2_GUID#.D0.98.D0.B4.D0.B5.D0.BD.D1.82.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.82.D0.BE.D1.80.D1.8B_.28GUID.29_.D1.80.D0.B0.D0.B7.D0.BB.D0.B8.D1.87.D0.BD.D1.8B.D1.85_.D1.82.D0.B8.D0.BF.D0.BE.D0.B2_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.BE.D0.B2 "wikipedia:ru:Таблица разделов GUID")|Рекомендуемый размер|
|---|---|---|---|
|`/mnt/boot`1|`/dev/_системный_раздел_efi_`|[Системный раздел EFI](https://wiki.archlinux.org/title/%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%BD%D1%8B%D0%B9_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB_EFI "Системный раздел EFI")|Минимум 300 МиБ. При установке нескольких ядер лучше 1 ГиБ или более.|
|`[SWAP]`|`/dev/_раздел_подкачки_`|Linux swap|Более 512 МиБ|
|`/mnt`|`/dev/_корневой_раздел_`|Linux x86-64 root (/)|Остаток|

1. Можно использовать [другие точки монтирования](https://wiki.archlinux.org/title/EFI_system_partition_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A2%D0%B8%D0%BF%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D1%82%D0%BE%D1%87%D0%BA%D0%B8_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F "EFI system partition (Русский)"), например `/mnt/efi`, если используемый загрузчик будет способен загрузить ядро и initramfs с корневого раздела. Смотрите соответствующее предупреждение в статье [Процесс загрузки Arch#Загрузчик](https://wiki.archlinux.org/title/%D0%9F%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8_Arch#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA "Процесс загрузки Arch").
###### BIOS с MBR

|Точка монтирования|Раздел|[Тип раздела](https://en.wikipedia.org/wiki/ru:%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BE%D1%87%D0%BD%D0%B0%D1%8F_%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D1%8C#.D0.9A.D0.BE.D0.B4_.D1.82.D0.B8.D0.BF.D0.B0_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B0 "wikipedia:ru:Главная загрузочная запись")|Рекомендуемый размер|
|---|---|---|---|
|`[SWAP]`|`/dev/_раздел_подкачки_`|Linux swap|Более 512 МиБ|
|`/mnt`|`/dev/_корневой_раздел_`|Linux|Остаток|

Также смотрите [Разметка дисков#Примеры схем](https://wiki.archlinux.org/title/%D0%A0%D0%B0%D0%B7%D0%BC%D0%B5%D1%82%D0%BA%D0%B0_%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B_%D1%81%D1%85%D0%B5%D0%BC "Разметка дисков").


Если сильно упростить, то с п.м. **fdisk** или **cfdisk** создайте несколько разделов. 

1. Раздел для UEFI размером более 300MB если у вас GPT;
2. Раздел для подкачки (swap) размером более 512MB;
3. Корневой раздел;
4. Домашний раздел (если вы хотите более безопасности данных);

Создание отдельного раздела для каталога home при установке Arch Linux может иметь несколько причин:

1. Удобство резервного копирования и восстановления данных: Отдельный раздел для каталога home позволяет легко сделать резервную копию данных пользователей и восстановить их в случае необходимости. Это может быть полезно, если требуется переустановить систему или изменить разделы диска без потери личных файлов.

2. Облегчение обновления системы: Если у вас отдельный раздел для каталога home, вы можете обновить систему, переустановив только корневой раздел, оставив данные на разделе home нетронутыми. Это может существенно сократить время, затрачиваемое на обновление системы.

3. Безопасность данных: Создав отдельный раздел для каталога home, вы можете применить различные методы шифрования, чтобы защитить свои персональные данные от несанкционированного доступа.

4. Поддержка множества операционных систем: Если вы планируете установить несколько операционных систем на одном компьютере, иметь отдельный раздел для каталога home позволит вам обмениваться данными между различными ОС без необходимости создавать отдельные разделы для каждой из них.

5. Лучшая производительность: Разделение операционной системы и пользовательских данных на отдельные разделы может улучшить производительность системы, поскольку операционная система и пользовательские данные могут работать независимо друг от друга.

Хотя создание отдельного раздела для каталога home не является обязательным, это может быть полезной практикой в определенных ситуациях, предоставляя дополнительные преимущества и удобства.

> Размер корневого и домашнего раздела вы можете выбрать под вашему усмотрение и предпочтении.


В итоге у вас примерно должен быть следующее: 

![[Pasted image 20230814050947.png]]

![[Pasted image 20230814051727.png]]


![[Pasted image 20230814051623.png]]

Еще один важный момент, внимательно настройте тип раздела, для домашнего (если вы его создали)  и корневого раздела тип **Linux**, для подкачки **swap**, а для  uefi, тип **EFI system**. 

Как можно понять если у вас BIOS c MBR вам не нужно создавать специальных разделов.

Проверьте созданные разделы командой `lsblk`:

![[Pasted image 20230814052309.png]]

или можно командой:

```
# fdisk -l
```

#### Форматирование разделов

После создания разделов их нужно отформатировать в подходящую [файловую систему](https://wiki.archlinux.org/title/%D0%A4%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D1%8B%D0%B5_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B "Файловые системы"). Для получения дополнительной информации смотрите раздел [Файловые системы#Создание файловой системы](https://wiki.archlinux.org/title/%D0%A4%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D1%8B%D0%B5_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%BE%D0%B9_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B "Файловые системы").

Домашний раздел (если вы его создали) и корневой раздел должны быть формата **ext4**, а раздел uefi должен иметь формат **fat32**.

Например, чтобы отформатировать `/dev/_корневой_раздел` в файловую систему [Ext4](https://wiki.archlinux.org/title/Ext4_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Ext4 (Русский)"), выполните следующую команду:

```
# mkfs.ext4 /dev/_корневой_раздел
```

Или же:

```
mkfs -t ext4 -L Root /dev/sda3
```

Если вы создали раздел для /home:

```
# mkfs.ext4 /dev/_домашний_раздел
```

Или же:

```
# mkfs -t ext4 -L Home /dev/sda5
```

Если вы создали раздел для подкачки ([swap](https://wiki.archlinux.org/title/Swap_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Swap (Русский)")), инициализируйте его с помощью утилиты [mkswap(8)](https://man.archlinux.org/man/mkswap.8):

```
# mkswap /dev/_раздел_подкачки
```

**Примечание:** В случае с многоуровневыми (stacked) блочными устройствами замените `/dev/_*_раздел_` соответствующим путём к блочному устройству.

Если вы создали системный раздел EFI, [отформатируйте его](https://wiki.archlinux.org/title/EFI_system_partition_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A4%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B0 "EFI system partition (Русский)") в FAT32 с помощью [mkfs.fat(8)](https://man.archlinux.org/man/mkfs.fat.8).

> **Важно:** Выполняйте форматирование, только если вы создали новый раздел в процессе разметки. Если системный раздел EFI уже существует, его форматирование уничтожит загрузчики других установленных операционных систем.

```
# mkfs.fat -F 32 /dev/_системный_раздел_efi
```

Если вы ранее создали раздел подкачки ([swap](https://wiki.archlinux.org/title/Swap_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Swap (Русский)")), активируйте его с помощью [swapon(8)](https://man.archlinux.org/man/swapon.8):

```
# swapon /dev/_раздел_подкачки
```

В дальнейшем [genfstab(8)](https://man.archlinux.org/man/genfstab.8) обнаружит смонтированные файловые системы и пространство подкачки.

Напомню что, если во время разметки диска вы создали раздел подкачки, или же он уже был на вашем диске, то его необходимо инициализировать. Выполняем команды (/dev/sda2 — это раздел подкачки):

```
# mkswap /dev/sdax
# swapon /dev/sdax
```

В дальнейшем [genfstab(8)](https://man.archlinux.org/man/genfstab.8) обнаружит смонтированные файловые системы и пространство подкачки.

#### Монтирование разделов

Чтобы установить файлы системы на только что созданные разделы, их нужно сначала примонтировать. Монтировать будем в папку /mnt. Сначала нужно примонтировать корневой раздел. 

[Смонтируйте](https://wiki.archlinux.org/title/%D0%A1%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D1%83%D0%B9%D1%82%D0%B5 "Смонтируйте") корневой раздел в каталог `/mnt`. Например, если корневой раздел — `/dev/_корневой_раздел`, выполните следующую команду:

```
# mount /dev/_корневой_раздел /mnt
```

Создайте точки монтирования для всех остальных разделов (например, `/mnt/boot`) и примонтируйте соответствующие разделы.

**Совет:** Команда [mount(8)](https://man.archlinux.org/man/mount.8), запущенная с опцией `--mkdir`, автоматически создаст требуемую точку монтирования. Можно создать их и вручную с помощью [mkdir(1)](https://man.archlinux.org/man/mkdir.1).

Для UEFI примонтируйте системный раздел EFI:

```
# mount --mkdir /dev/_системный_раздел_efi /mnt/boot/efi
```

Или код может выглядит примерно так:

```
# mkdir /mnt/{boot/efi,home}
```

Осталось выполнить монтирование:

```
# mount /dev/раздел_efi /mnt/boot/efi
# mount /dev/раздел_home /mnt/home
```

Простыми словами, вам нужно выполнить следующие шаги:

1. Монтировать корневой радел в каталоге **/mnt**;
2. Создать папку **home** (если вы создали раздел для него) в разделе **/mnt**;
3. Создать папку **boot** (для UEFI) в каталоге **/mnt**;
4. Активировать раздел подкачки;

![[Pasted image 20230814232209.png]]

#### Установка 

##### Выбор зеркал

Пакеты для установки будут скачиваться с [серверов-зеркал](https://wiki.archlinux.org/title/Mirrors_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Mirrors (Русский)"), прописанных в файле `/etc/pacman.d/mirrorlist`. В установочном образе используется [reflector](https://wiki.archlinux.org/title/Reflector_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Reflector (Русский)"), который после подключения к сети обновит список зеркал (выбрав 20 наиболее актуальных HTTPS-зеркал) и отсортирует их по скорости загрузки.

Чем выше зеркало расположено в списке, тем больший приоритет оно имеет при скачивании пакета. Вы можете проверить этот файл и, при необходимости, [отредактировать](https://wiki.archlinux.org/title/Help:Reading_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C "Help:Reading (Русский)") его вручную, переместив наверх наиболее географически близкие зеркала. При этом также учитывайте и другие критерии.

Позже _pacstrap_ скопирует этот файл в новую систему, так что это действительно стоит сделать.

По умолчанию все пакеты новой системы будут скачиваться с зеркал, настроенных в **/etc/pacman.d/mirrorlist**. Этот файл генерируется во время загрузки Live системы с помощью утилиты **reflector** на основе двадцати самых быстрых зеркал. Однако вы можете отредактировать файл и поднять географически близкие до ваз зеркала вверх:

```
# vim /etc/pacman.d/mirrorlist
```

![[Pasted image 20230814232642.png]]

Для сохранения изменений наберите: **:wq**

Есть последний шаг, прежде чем вы сможете установить Arch Linux на свой компьютер, и это настройка зеркал. Зеркала - это серверы, расположенные в разных точках по всему миру для обслуживания близлежащего населения.

Установщик поставляется с Reflector, скриптом Python, написанным для получения последнего списка зеркал на странице [Arch Linux Mirror Status](https://archlinux.org/mirrors/status/). Чтобы распечатать последний зеркальный список, просто выполните следующую команду:

```bash
№ reflector
```

Если у вас медленное подключение к Интернету, вы можете столкнуться со следующим сообщением об ошибке:

```bash
failed to rate http(s) download (https://arch.jensgutermuth.de/community/os/x86_64/community.db): Download timed out after 5 second(s).
```

Это происходит, когда тайм-аут по умолчанию (5 секунд) меньше фактического времени, необходимого для загрузки информации.

Вы можете решить эту проблему, используя опцию:`--download-timeout`

```bash
№ reflector --download-timeout 60
```

Теперь отражатель будет ждать целую минуту, прежде чем начать кричать. На вашем экране должен появиться длинный список зеркал:

![[Pasted image 20230816020737.png]]

Пройтись по всему списку, чтобы найти ближайшие зеркала, было бы больно. Вот почему рефлектор может сделать это за вас.

Reflector может генерировать список зеркал на основе множества заданных ограничений. Например, мне нужен список зеркал, которые были синхронизированы в течение последних 12 часов и которые расположены либо в Индии, либо в Сингапуре (эти два находятся ближе всего к моему местоположению), и отсортировать зеркала по скорости загрузки.

Оказывается, рефлектор может это сделать:

```bash
reflector --download-timeout 60 --country India,Singapore --age 12 --protocol https --sort rate
```

Найденные серверы будут перечислены, как и раньше:

![[Pasted image 20230816020824.png]]

Распечатать такой зеркальный список недостаточно. Вам нужно будет сохранить список в расположении. Pacman, менеджер пакетов по умолчанию для Arch Linux, использует этот файл для изучения зеркал.`/etc/pacman.d/mirrorlist`

Перед перезаписью зеркального списка по умолчанию сделайте его копию:

```
# cp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.bak
```

Теперь выполните команду reflector с опцией следующим образом:`--save`

```
# reflector --download-timeout 60 --country India,Singapore --age 12 --protocol https --sort rate --save /etc/pacman.d/mirrorlist
```

Эта команда сгенерирует зеркальный список и перезапишет список по умолчанию. Теперь вы готовы установить базовую систему Arch Linux.

##### Установка основных пакетов 

###### Как установить базовую систему Arch Linux

Перед установкой базовой системы рекомендуется обновить кэш пакетов в соответствии с новым списком зеркал. Для этого выполните следующую команду:

```bash
pacman -Sy
```

Программа для Arch Linux - это то, что для Ubuntu или для Fedora. Опция означает синхронизацию, которая эквивалентна менеджерам пакетов или менеджерам пакетов.`pacman``apt``dnf``-S``install``apt``dnf`

**Примечание:** Никакие программы или настройки (кроме файла `/etc/pacman.d/mirrorlist`) из live-окружения в устанавливаемую систему не переносятся.

После завершения процесса обновления вы можете использовать скрипт для установки системы Arch Linux. Выполните следующую команду, чтобы начать процесс установки:`pacstrap`. Используйте скрипт [pacstrap(8)](https://man.archlinux.org/man/pacstrap.8), чтобы установить пакет [base](https://archlinux.org/packages/?name=base), [ядро](https://wiki.archlinux.org/title/%D0%AF%D0%B4%D1%80%D0%BE "Ядро") Linux и прошивки часто встречающихся устройств:

```
# pacstrap -K /mnt base linux linux-firmware
```

Или:

```
# pacstrap /mnt base linux linux-firmware
```

Также можно:

```
# pacstrap -i /mnt base linux linux-firmware dhcpcd
```

Или же: 

```
# pacstrap /mnt base base-devel linux linux-firmware sudo nano ntfs-3g networkmanager
```

![[Pasted image 20230814233134.png]]

1. Как уже отмечали, при установке базовых пакетов нужно, помимо base, еще добавить для установки base-devel, linux и linux-firmware. Кроме этого, абсолютно обязательно поставить dhcpcd. В противном случае, получится трагикомическая ситуация - после перезагрузки включить Интернет не получится т.к. нет dhcpcd, а установить dhcpcd нельзя поскольку еще нет Интернета. Возможно, есть какой-то замысловатый выход, но зачем, если можно добавить всего одно коротенькое слово и спокойно следовать инструкции?  
2. После входа в chroot редактор nano исчезает, его тоже надо поставить, хотя можно это сделать и позднее, при возникновении необходимости, но почему бы не сразу? Кроме этого, в дальнейшем для редактирования sudo нам понадобится редактор vi. Почему бы не поставить его заранее дабы в дальнейшем не отвлекаться от инструкции?  
  
Таким образом, команда установки базового пакета у нас несколько расширяется.  
Было:  

```
# pacstrap /mnt base  
```

Стало:  

```
# pacstrap /mnt base base-devel linux linux-firmware dhcpcd nano vi  
```
  
Кстати, после такой расширенной установки пропадает необходимость на втором этапе отдельно устанавливать sudo т.к. уже имеется в одном из пакетов. Т.е., сразу, как придет время набираем visudo (vi предусмотрительно установлен) и редактируем.

Скрипт может устанавливать пакеты в указанный новый корневой каталог. Как вы, возможно, помните, корневой раздел был смонтирован в точке монтирования, так что это то, что вы будете использовать с этим скриптом. Затем вы передадите имена пакетов, которые хотите установить:`pacstrap``/mnt`

- `base` - Минимальный набор пакетов для определения базовой установки Arch Linux.
- `base-devel` – Группа пакетов, необходимых для сборки программного обеспечения из исходного кода.
- `linux` – Само ядро.
- `linux-firmware` – Драйверы для общего оборудования.
- `sudo` - Вы хотите запускать команды от имени root, верно?
- `nano` - Клон редактора pico с некоторыми улучшениями.
- `ntfs-3g` – Драйвер файловой системы NTFS и утилиты, необходимые для работы с дисками NTFS.
- `networkmanager` – Обеспечивает обнаружение и настройку систем для автоматического подключения к сетям.

Я хотел бы уточнить, что этот список из семи пакетов не является чем-то обязательным. Чтобы иметь функциональную установку Arch Linux, вам просто нужны пакеты , и . Но, учитывая, что вам все равно понадобятся другие, почему бы не поймать их всех за один раз.`base``linux``linux-firmware`

В зависимости от вашего интернет-соединения процесс установки может занять некоторое время. Сядьте поудобнее и расслабьтесь, пока не сделаете свое дело. Как только это будет сделано, вы увидите что-то вроде следующего:`pacstrap`

**Совет:**

- [linux](https://archlinux.org/packages/?name=linux) можно заменить на другой желаемый пакет [ядра](https://wiki.archlinux.org/title/%D0%AF%D0%B4%D1%80%D0%B0 "Ядра"). Можно вообще не устанавливать ядро, если установка происходит в [контейнере](https://en.wikipedia.org/wiki/ru:%D0%9A%D0%BE%D0%BD%D1%82%D0%B5%D0%B9%D0%BD%D0%B5%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F "wikipedia:ru:Контейнеризация").
- Можно пропустить установку пакета прошивок, если установка происходит в контейнере или виртуальной машине.

Пакет [base](https://archlinux.org/packages/?name=base) содержит не все инструменты, имеющиеся на установочном носителе, из-за чего может потребоваться установка дополнительных пакетов для получения полностью функциональной базовой системы. Чтобы [установить](https://wiki.archlinux.org/title/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D1%8C "Установить") другие пакеты или группы, добавьте их названия к команде _pacstrap_ (разделяя их пробелом) или используйте [pacman](https://wiki.archlinux.org/title/Pacman_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Pacman (Русский)") во время этапа [#Chroot](https://wiki.archlinux.org/title/installation_guide_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#Chroot). В частности, вам могут пригодиться следующие программы:

- утилиты для управления [файловыми системами](https://wiki.archlinux.org/title/File_systems_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "File systems (Русский)") в пользовательском пространстве, которые будут использоваться в системе;
- утилиты для доступа к [RAID](https://wiki.archlinux.org/title/RAID_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "RAID (Русский)")- или [LVM](https://wiki.archlinux.org/title/LVM_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "LVM (Русский)")-разделам;
- специфические прошивки других устройств, не включённые в [linux-firmware](https://archlinux.org/packages/?name=linux-firmware) (например, [sof-firmware](https://archlinux.org/packages/?name=sof-firmware) для некоторых [звуковых карт](https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture#ALSA_firmware "Advanced Linux Sound Architecture"));
- ПО, необходимое для [организации сети](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Network configuration (Русский)") (например, [сетевой менеджер](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5_%D0%BC%D0%B5%D0%BD%D0%B5%D0%B4%D0%B6%D0%B5%D1%80%D1%8B "Network configuration (Русский)") или [автономный DHCP-клиент](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#DHCP "Network configuration (Русский)"), [программу аутентификации](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)/Wireless_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%90%D1%83%D1%82%D0%B5%D0%BD%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F "Network configuration (Русский)/Wireless (Русский)") для Wi-Fi, [ModemManager](https://wiki.archlinux.org/title/ModemManager "ModemManager") для мобильного интернета);
- [текстовый редактор](https://wiki.archlinux.org/title/%D0%A2%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%B2%D1%8B%D0%B9_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%BE%D1%80 "Текстовый редактор");
- пакеты для доступа к документации в [man](https://wiki.archlinux.org/title/Man_page_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Man page (Русский)") и [info](https://wiki.archlinux.org/title/GNU_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#Texinfo "GNU (Русский)"): [man-db](https://archlinux.org/packages/?name=man-db), [man-pages](https://archlinux.org/packages/?name=man-pages) и [texinfo](https://archlinux.org/packages/?name=texinfo).

Список пакетов, присутствующих в установочном образе, доступен на странице [pkglist.x86_64.txt](https://geo.mirror.pkgbuild.com/iso/latest/arch/pkglist.x86_64.txt).


![[Pasted image 20230816021206.png]]

Поздравляем, вы успешно установили Arch Linux на свой компьютер. Все, что осталось сделать, это настроить систему.


#### Настройка системы

##### fstab

Сгенерируйте файл [fstab](https://wiki.archlinux.org/title/Fstab_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Fstab (Русский)") (используйте ключ `-U` или `-L`, чтобы для идентификации разделов использовались [UUID](https://wiki.archlinux.org/title/Persistent_block_device_naming_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#by-uuid "Persistent block device naming (Русский)") или метки, соответственно):

2 Создайте файл описания подключённых файловых систем fstab на основе точек монтирования /mnt с помощью команды:

```
# genfstab -U /mnt >> /mnt/etc/fstab
```

После этого проверьте файл `/mnt/etc/fstab` и [отредактируйте](https://wiki.archlinux.org/title/Help:Reading_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C "Help:Reading (Русский)") его в случае необходимости.
##### chroot

[Перейдите к корневому каталогу](https://wiki.archlinux.org/title/Chroot_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Chroot (Русский)") новой системы. Наша новая система установлена и для её дальнейшей настройки нам нужно войти в неё, но без перезагрузки, потому что загрузчик и сеть в ней ещё не готовы. Выполните команду для входа в систему:

```
# arch-chroot /mnt
```

![[Pasted image 20230815001926.png]]

##### Часовой пояс

Задайте [часовой пояс](https://wiki.archlinux.org/title/%D0%A7%D0%B0%D1%81%D0%BE%D0%B2%D0%BE%D0%B9_%D0%BF%D0%BE%D1%8F%D1%81 "Часовой пояс"):

```
# ln -sf /usr/share/zoneinfo/_Регион_/_Город /etc/localtime
```

![[Pasted image 20230815002333.png]]

Запустите [hwclock(8)](https://man.archlinux.org/man/hwclock.8), чтобы сгенерировать `/etc/adjtime`:

```
# hwclock --systohc
```

Эта команда предполагает, что аппаратные часы настроены в формате [UTC](https://en.wikipedia.org/wiki/ru:%D0%92%D1%81%D0%B5%D0%BC%D0%B8%D1%80%D0%BD%D0%BE%D0%B5_%D0%BA%D0%BE%D0%BE%D1%80%D0%B4%D0%B8%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B5_%D0%B2%D1%80%D0%B5%D0%BC%D1%8F "w:ru:Всемирное координированное время"). Для получения дополнительной информации смотрите раздел [System time (Русский)#Стандарт времени](https://wiki.archlinux.org/title/System_time_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82_%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8 "System time (Русский)").

##### Способ хранения таймера

Далее необходимо настроить способ синхронизации системного времени между перезагрузками. Есть два способа UTC и localtime. Если вы используете ещё и Windows, выберите localtime, иначе можно брать utc:

Выполним _hwclock_, чтобы сгенерировать файл _/etc/adjtime_, в котором хранятся соответсвующие настройки.

```
# hwclock --systohc
```

Можно также:

```
# hwclock --systohc --utc
```

Или:

```
# hwclock --systohc --localtime
```

##### Установка текстового редактора

По умолчанию в системе отсутствуют такие текстовые редакторы как vim и nano. Для их установки необходимо выполнить команды:

```
# pacman -Sy
# pacman -S vim
```

Для установки nano необходимо выполнить команду:

```
# pacman -S nano
```

##### Локализация

[Отредактируйте](https://wiki.archlinux.org/title/Help:Reading_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C "Help:Reading (Русский)") файл `/etc/locale.gen`, раскомментировав `en_US.UTF-8 UTF-8` и другие необходимые [локали](https://wiki.archlinux.org/title/%D0%9B%D0%BE%D0%BA%D0%B0%D0%BB%D0%B8 "Локали") (например, `ru_RU.UTF-8 UTF-8`), после чего сгенерируйте их:

```
# locale-gen
```

[Создайте](https://wiki.archlinux.org/title/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9%D1%82%D0%B5 "Создайте") файл [locale.conf(5)](https://man.archlinux.org/man/locale.conf.5) и [задайте переменной LANG](https://wiki.archlinux.org/title/Locale_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%BD%D0%BE%D0%B9_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D0%B8 "Locale (Русский)") необходимое значение:

```
/etc/locale.conf

LANG=ru_RU.UTF-8
```

Мы специально выбрали английскую локаль на время установки, поскольку если будут возникать ошибки, то при русской локали сообщения будут выводиться квадратиками и будет трудно понять, в чём причина проблемы.

Чтобы включить русский язык, введите:

```
   # echo "LANG=ru_RU.UTF-8" > /etc/locale.conf
```

Где **ru_RU.UTF-8** ― сгенерированный локаль.

Например, cоздадим **locale.conf** и экспортируем локаль. Это можно сделать так:

```
# echo LANG=en_US.UTF-8 > /etc/locale.conf
# export LANG=en_US.UTF-8
```

Если вы [меняли раскладку клавиатуры или шрифт](https://wiki.archlinux.org/title/installation_guide_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D1%80%D0%B0%D1%81%D0%BA%D0%BB%D0%B0%D0%B4%D0%BA%D0%B8_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D1%8B_%D0%B8_%D1%88%D1%80%D0%B8%D1%84%D1%82%D0%B0), сделайте эти изменения постоянными, прописав их в файле [vconsole.conf(5)](https://man.archlinux.org/man/vconsole.conf.5):
За эти параметры отвечает файл **/etc/vconsole.conf**. Добавьте в него такие строки:

```
/etc/vconsole.conf

KEYMAP=ru
FONT=cyr-sun16
```

Добавьте шрифт с поддержкой кириллицы в консоль:

   ```
   # echo "FONT=cyr-sun16" > /etc/vconsole.conf
   ```

Это можно сделать с п.м. vim, nano или даже echo. 

Простыми словами, Включите кодировки, с которыми сможет работать система. Для этого откройте файл **/etc/locale.gen**:

```
vim /etc/locale.gen
```

Раскомментируйте строки с нужным языком. Например:

```
en_US.UTF-8 UTF-8
ru_RU.UTF-8 UTF-8
```

![[Pasted image 20230815004553.png]]

Когда настройка будет завершена, запустите генерацию локалей:

```
# locale-gen
```

![[Pasted image 20230815004705.png]]


##### Настройка сети

Настройка сети вручную в любом дистрибутиве Linux может быть сложной. Вот почему я посоветовал вам установить пакет во время установки системы. Если вы сделали, как я сказал, все готово. В противном случае используйте для установки пакета сейчас: `networkmanager``pacman`

```
# pacman -S networkmanager
```

Включите службу, выполнив следующую команду:`NetworkManager`

```
# systemctl enable NetworkManager
```

Обязательно пишите, а не как имя службы. Если команда выполнена успешно, сетевой менеджер с этого момента будет автоматически запускаться при загрузке и делать свое дело.`NetworkManager``networkmanager`
###### hostname

Создайте файл [hostname](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%98%D0%BC%D1%8F_%D1%85%D0%BE%D1%81%D1%82%D0%B0 "Network configuration (Русский)"):

```
/etc/hostname

моёимяхоста
```

Это можно сделать с п.м. vim:

```
# vim /etc/hostname
```

И добавим имя хоста.

Или путь покороче:

```
# echo hostname > /etc/hostname
```

Завершите [настройку сети](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Network configuration (Русский)") для вновь установленной среды. В частности, установите подходящее ПО для [управления сетевым подключением](https://wiki.archlinux.org/title/Network_configuration_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%BC_%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC "Network configuration (Русский)").
###### hosts

Создайте файл [[hosts]]:

```
/etc/hosts

127.0.0.1    localhost    
::1          localhost    
127.0.1.1    hostname
```

Это можно сделать так:

```
# vim /etc/hosts
```

И добавим имя хоста:

```
127.0.0.1 hostname.localdomaina   hostname
```

![[Pasted image 20230815005832.png]]

Настраиваем сеть. Если у вас проводное соединение, то включите автоматическое получение IP адреса:

```
# systemctl enable dhcpcd.service
```

Если у вас Wi-Fi соединение, то при первой перезагрузке нужно будет настроить его вручную.

**Внимание тем, у кого подключение по Wi-Fi**: обязательно установите пакеты:

```
# pacman -S wpa_supplicant dhclient iw
```

##### Initramfs

Как правило, создание нового образа _initramfs_ не требуется, поскольку _pacstrap_ автоматически запускает [mkinitcpio](https://wiki.archlinux.org/title/Mkinitcpio_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Mkinitcpio (Русский)") после установки пакета [ядра](https://wiki.archlinux.org/title/%D0%AF%D0%B4%D1%80%D0%B0 "Ядра").

Если вы используете [LVM](https://wiki.archlinux.org/title/Install_Arch_Linux_on_LVM#Adding_mkinitcpio_hooks "Install Arch Linux on LVM"), [шифрование системы](https://wiki.archlinux.org/title/Dm-crypt_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Dm-crypt (Русский)") или [RAID](https://wiki.archlinux.org/title/RAID#Configure_mkinitcpio "RAID"), отредактируйте файл [mkinitcpio.conf(5)](https://man.archlinux.org/man/mkinitcpio.conf.5) и пересоздайте образ _initramfs_:

```
# mkinitcpio -P
```

или же:

```
# mkinitcpio -p linux
```

##### Пароль суперпользователя

Установите [пароль](https://wiki.archlinux.org/title/Users_and_groups_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%D0%BC%D0%B8 "Users and groups (Русский)") суперпользователя:

```
# passwd
```

Такой простой командой мы устанавливаем пароль рута.

##### Загрузчик

###### BIOS 

Выберите и установите [загрузчик](https://wiki.archlinux.org/title/%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA "Загрузчик") с поддержкой Linux. Если вы используете процессор Intel или AMD, включите также обновление [микрокода](https://wiki.archlinux.org/title/%D0%9C%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%B4 "Микрокод").

Сначала установим пакет grub, для этого выполняем команду:

```
# pacman -S grub
```

Если вы используете или планируете использовать на этом компьютере не только ОС Linux, но и другие операционные системы, например, Windows, то установите пакет _os-prober_:

```
pacman -S os-prober
```

Теперь инсталлируем grub:

```
grub-install /dev/sda
```

Обратите внимание на то, что в команде мы указываем устройство (_/dev/sda_), а не раздел. Загрузчик устанавливается в каталог _/boot_.  
Если команда выполнится без ошибок, то вы получите сообщение вида: _Installation finished. No error reported_.

Если вы устанавливаете вместе с другими операционными системами, вам придется включить перед созданием файла конфигурации. Для этого откройте файл в текстовом редакторе nano. Найдите следующую строку и раскомментируйте ее: `os-prober``/etc/default/grub`

```
# GRUB_DISABLE_OS_PROBER=false
```

![[Pasted image 20230816073456.png]]

Запускаем автоматическую настройку grub:

```
grub-mkconfig -o /boot/grub/grub.cfg
```

У меня в процессе выполнения данной команды выскочило предупреждение: _WARNING: failed to connect to lvmetad: No such file or directory. Falling back to internal scanning._ В руководстве по ArchLinux сказано, что это нормально и данное сообщение можно проигнорировать.

###### UEFI

Это один из важнейших шагов, и он отличается для систем UEFI и других систем. Позвольте мне сначала упомянуть **шаги для систем UEFI**.

Убедитесь, что вы все еще используете **arch-chroot**. Установите необходимые пакеты:

```
# pacman -S grub efibootmgr
```

Создайте директорию, в которую будет смонтирован раздел EFI:

```
# mkdir /boot/efi
```

Теперь смонтируйте созданный вами раздел ESP

```
# mount /dev/sda1 /boot/efi
```

Установите grub следующим образом:

```
# grub-install --target=x86_64-efi --bootloader-id=GRUB --efi-directory=/boot/efi
```

Если вы устанавливаете вместе с другими операционными системами, вам придется включить перед созданием файла конфигурации. Для этого откройте файл в текстовом редакторе nano. Найдите следующую строку и раскомментируйте ее: `os-prober``/etc/default/grub`

```
# GRUB_DISABLE_OS_PROBER=false
```

![[Pasted image 20230816073456.png]]

Последний шаг:

```
# grub-mkconfig -o /boot/grub/grub.cfg
```


#### Настройки пользовательского окружения
##### Создание пользователя

Сейчас вы работаете от имени пользователя root. Создадим обычного пользователя, от имени которого вы и будете пользоваться системой. Я создал пользователя _pingvinus_ (вместо _pingvinus_ укажите имя вашего пользователя).

```
useradd -m -g users -G wheel -s /bin/bash <username>
```

Теперь в директории _/home_ появится домашняя директория пользователя. Ее можно посмотреть командой ls:

```
$ ls /home
<username>
```

Зададим пароль для только что созданного пользователя:

```
passwd <username>
```

Или можете сначала создать пользователя, потом задать ему пароль, после дать ему разрешение с **usermod**:

```
# useradd -m <username>
# passwd <username>
# usermod -aG wheel,audio,video,optical,storage <username>
```

Можем посмотреть параметры пользователя:

```
# userdbctl groups-of-user <username>
```


##### Настройка интернет

У меня используется проводное Ethernet соединение. IP адрес система получает автоматически. Поэтому необходимо включить сервис DHCP. Выполняем команды:

```
systemctl enable dhcpcd.service
systemctl start dhcpcd.service
```

Ждем несколько секунд пока система получит IP-адрес. Можно проверить соединение, выполнив ping:

```
ping -c 5 google.com
```

##### Установка sudo

Установим _sudo_ и позволим нашему пользователю использовать _sudo_.

Для установки _sudo_ выполните команду:

```
pacman -S sudo
```

Теперь разрешим пользователям группы _wheel_ использование _sudo_. Когда мы создавали пользователя, то мы добавили его в группу _wheel_, поэтому он сможет пользоваться _sudo_. Выполняем команду:

```
visudo
```

Откроется редактор Vi с файлом настроек _sudo_.

Найдите строку «# %wheel ALL=(ALL) ALL» (перемещайте курсор вниз клавишей Стрелка Вниз. Строка закомментирована (перед ней стоит символ решетки #).

![[Pasted image 20230816012650.png]]

Нам нужно раскомментировать ее (то есть удалить символ решетки). Поместите курсор на символ решетки и нажмите клавишу x. Также можно удалить пробел, который стоял после решетки.

![[Pasted image 20230816012737.png]]

Теперь нужно сохранить изменения и закрыть редактор. Для этого нажмите двоеточие «**:**», в нижней части экрана появится строка для ввода символов. Введите wq или exit и нажмите Enter. Если вдруг вы не хотите сохранять изменения, а хотите просто закрыть редактор, то вместо wq или exit введите q!.

![[Pasted image 20230816012834.png]]


##### Установка среды рабочего стола

###### Установка [[Графический сервер|графического сервера]]

Первым шагом является установка окружения X. Введите приведенную ниже команду, чтобы установить [Xorg в качестве сервера отображения](https://itsfoss.com/display-server/) вместе с сетевым менеджером. Вы можете обратиться к [официальной документации](https://wiki.archlinux.org/title/wayland?ref=itsfoss.com) к Wayland.

**Прежде всего установим «иксы» — Xorg.** Выполняем команду:

```
# pacman -S xorg 
```

Или же:

```
# pacman -S xorg-server
```

###### Установка [[Дисплейный менеджер|экранного менеджера]]

Экранный менеджер запускается сразу после загрузки системы. В нем вы выбираете пользователя для входа в систему и вводите пароль. Существует несколько разных экранных менеджеров, я устанавливал LightDM:

```
pacman -S lightdm lightdm-gtk-greeter
```

Разрешим автоматический запуск lightdm при загрузке системы:

```
systemctl enable lightdm.service
```

Вы можете установить sddm или любой другой экранный менеджер.

###### Установка [[Графическая оболочка|графического оболочки]] 

Теперь, когда вы установили Xorg и необходимые графические драйверы, вы готовы установить среду рабочего стола, такую как GNOME, Plasma или XFCE.

Arch Linux поддерживает длинный список сред рабочего стола, но я пробовал только GNOME и Plasma. Я продемонстрирую, как вы можете установить любой из этих двух.


**Как установить GNOME**

Чтобы установить GNOME, вам нужно будет установить пакет. Для этого выполните следующую команду:`gnome`

```bash
pacman -S gnome
```

Во время установки вам будет предложено несколько вариантов и пакетов. Примите значения по умолчанию, нажав Enter в обоих запросах. Установка может занять некоторое время.`pipwire-session-manager``emoji-font`

Пакет поставляется с GDM или Gnome Display Manager. Вы можете включить службу, выполнив следующую команду:`gnome`

```bash
systemctl enable gdm
```

Это все, что вам нужно сделать, чтобы запустить GNOME в вашей системе Arch.

**Как установить плазму**

Установка KDE Plasma мало чем отличается от GNOME. Вам нужно будет установить пакеты, связанные с Plasma, вместо GNOME.

```
# sudo pacman -S plasma
```

Или же:

```
# pacman -S plasma plasma-wayland-session
```

Если у вас есть видеокарта NVIDIA, избегайте ее установки и используйте обычную старую X11. У меня есть два устройства с графическими процессорами NVIDIA, и оба они показали нестабильность при использовании Wayland.`plasma-wayland-session`

Во время установки вы получите несколько вариантов для , и пакетов. Обязательно выберите в качестве своего и примите значения по умолчанию для двух других.`ttf-font``pipwire-session-manager``phonon-qt5-backend``noto-fonts``ttf-font`

Как и в GNOME, Plasma поставляется в качестве менеджера отображения по умолчанию. Выполните следующую команду, чтобы включить службу:`gdm``sddm`

```
# systemctl enable sddm
```

И это все, что вам нужно сделать, чтобы запустить Plasma в вашей системе Arch Linux.

Для установки KDE выполните команду:

```
# sudo pacman -S plasma
```

**Установка Mate**

Для установки Mate выполните команду:

```
sudo pacman -S mate mate-extra
```

**Установка Cinnamon**

Для установки Cinnamon выполните команду:

```
# sudo pacman -S cinnamon
```

##### Завершение установки

Выйдите из окружения chroot, набрав `exit` или нажав `Ctrl+d`.

Вы можете размонтировать все разделы с помощью команды `umount -R /mnt`, чтобы убедиться в том, что ни один из разделов не остался занят какой-либо программой. Если нужно, для поиска таких программ используйте [fuser(1)](https://man.archlinux.org/man/fuser.1).

Теперь, когда вы установили Arch Linux и выполнили все необходимые шаги настройки, вы можете перезагрузиться в только что установленную систему. Для этого сначала выйдите из среды Arch-Chroot:

```
# exit
```

Затем отключите корневой раздел, чтобы убедиться в отсутствии ожидающих операций:

```
# umount -R /mnt
```

Или же: 

```
# umount /mnt
```

Также можно: 

```
# umount -l /mnt
```


Теперь перезагрузите компьютер, набрав `reboot`:

```
# reboot
```

Если какие-нибудь разделы остались смонтированными, [systemd](https://wiki.archlinux.org/title/Systemd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Systemd (Русский)") их размонтирует. Не забудьте извлечь установочный носитель. После загрузки войдите в систему в качестве суперпользователя.

Подождите, пока не появится меню GRUB.

##### После установки

Дальнейшие указания по настройке системы после установки (например, создание аккаунта обычного пользователя, настройка графического интерфейса, звука или тачпада) описаны на странице [Основные рекомендации](https://wiki.archlinux.org/title/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D1%8B%D0%B5_%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8 "Основные рекомендации").

Множество интересных и полезных программ вы найдёте на странице [Список приложений](https://wiki.archlinux.org/title/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9 "Список приложений").

