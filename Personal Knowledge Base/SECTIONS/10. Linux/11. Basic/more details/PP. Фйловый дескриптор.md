


Файловый дескриптор — это неотрицательное число, которое является идентификатором потока ввода-вывода. Дескриптор может быть связан с файлом, каталогом, сокетом.

Например, когда вы открываете или создаете новый файл, операционная система формирует для себя запись для представления этого файла и хранения информации о нем. У каждого файла индивидуальный файловый дескриптор Linux. Открыли 100 файлов — где-то в ядре появились 100 записей, представленных целыми числами. Простыми словами, Дескриптор файла - это целое число без знака, с помощью которого процесс обращается к открытому файлу. Всё еще не поняли? Тогда так - Дескриптор файла - это номер, который однозначно идентифицирует открытый файл в операционной системе компьютера. В ядре все открытые файлы называются файловыми дескрипторами. Дескриптор файла - это неотрицательное число. Когда мы открываем существующий файл или создаем новый файл, [[AA. Ядро linux | ядро]] возвращает файловый дескриптор процессу. Ядро поддерживает таблицу всех используемых дескрипторов открытых файлов.

  
  

Дескриптор для каждого процесса является уникальным. Но есть три жестко закрепленных индекса — это первые три номера (0, 1, 2).

-   0 — стандартный ввод (stdin), место, из которого программа получает интерактивный ввод.
    
-   1 — стандартный вывод (stdout), на который направлена большая часть вывода программы.
    
-   2 — стандартный поток ошибок (stderror), в который направляются сообщения об ошибках.
    

Файловый дескриптор — это неотрицательное число, которое является идентификатором потока ввода-вывода. Дескриптор может быть связан с файлом, каталогом, сокетом.

Например, когда вы открываете или создаете новый файл, операционная система формирует для себя запись для представления этого файла и хранения информации о нем. У каждого файла индивидуальный файловый дескриптор Linux. Открыли 100 файлов — где-то в ядре появились 100 записей, представленных целыми числами. Простыми словами, Дескриптор файла - это целое число без знака, с помощью которого процесс обращается к открытому файлу. Всё еще не поняли? Тогда так - Дескриптор файла - это номер, который однозначно идентифицирует открытый файл в операционной системе компьютера. В ядре все открытые файлы называются файловыми дескрипторами. Дескриптор файла - это неотрицательное число. Когда мы открываем существующий файл или создаем новый файл,[[AA. Ядро linux | ядро]] возвращает файловый дескриптор процессу. [[AA. Ядро linux | Ядро]]  поддерживает таблицу всех используемых дескрипторов открытых файлов.
  
Если вы всё еще не поняли, то обьясним немного по другому. В Linux библиотека libc открывает для каждого запущенного приложения(процесса) 3 файл дескриптора, с номерами 0,1,2. Больше информации вы можете найти по ссылкам [man stdio](http://man7.org/linux/man-pages/man3/stdio.3.html) и [man stdout](http://man7.org/linux/man-pages/man3/stdout.3.html)

-   Файл дескриптор 0 называется STDIN и ассоциируется с вводом данных у приложения
    
-   Файл дескриптор 1 называется STDOUT и используется приложениями для вывода данных, например командами print
    
-   Файл дескриптор 2 называется STDERR и используется приложениями для вывода данных, сообщающих об ошибке
    

В системе по-умолчанию всегда открыты три "файла" -- stdin (клавиатура), stdout (экран) и stderr (вывод сообщений об ошибках на экран). Эти, и любые другие открытые файлы, могут быть перенапрвлены. В данном случае, термин "перенаправление" означает получить вывод из файла, команды, программы, сценария или даже отдельного блока в сценарии (см. [Пример 3-1](https://www.opennet.ru/docs/RUS/bash_scripting_guide/c301.html#EX8) и [Пример 3-2](https://www.opennet.ru/docs/RUS/bash_scripting_guide/c301.html#RPMCHECK)) и передать его на вход в другой файл, команду, программу или сценарий.

С каждым открытым файлом связан дескриптор файла. Дескрипторы файлов stdin, stdout и stderr -- 0, 1 и 2, соответственно

Обычно файловые дескрипторы выделяются последовательно. Есть пул свободных номеров. Когда вы создаете новый файл или открываете существующий, ему присваивается номер. Следующий файл получает очередной номер — например, 101, 102, 103 и так далее.


  ![[Pasted image 20220820065258.png]]
  

Если в вашей программе вы откроете какой-либо файл на чтение или запись, то скорее всего вы получите первый свободный ID и это будет номер 3.

Количество дескрипторов файлов, доступных процессу, ограничено параметром /OPEN_MAX, заданным в файле sys/limits.h. Кроме того, количество дескрипторов файлов можно задать с помощью флага -n команды `ulimit`. Дескрипторы файлов создаются при выполнении функций `open`, `pipe`, `creat` и `fcntl`. Обычно каждый процесс работает с уникальным набором дескрипторов. Однако эти же дескрипторы могут применяться и дочерними процессами, созданными с помощью функции fork. Кроме того, дескрипторы можно скопировать с помощью функций `fontal`, `dup` и `dup2`.

Все открытые файлы ссылаются к ядру через так называемые файловые дескрипторы. **Файловый дескриптор** — это неотрицательное целое число. Когда мы открываем существующий файл и создаем новый файл, [[AA. Ядро linux | ядро]] возвращает процессу файловый дескриптор. Стандарт POSIX.1 заменил «магические числа» 0,1,2 символическими константами STDIN_FILENO, STDOUT_FILENO и STDERR_FILENO соответственно. Когда вы завершаете работу с файлом, присвоенный ему дескриптор освобождается и возвращается в пул свободных номеров. Он снова доступен для выделения под новый файл.
  

Когда нужно выполнить ввод или вывод, процесс через системный вызов передает ядру дескриптор нужного файла. [[AA. Ядро linux | Ядро]]  обращается к файлу от имени процесса. При этом у самого процесса нет доступа к файлу или таблице индексных дескрипторов.


![[Pasted image 20220820065638.png]]


![[Pasted image 20220820065651.png]]


![[Pasted image 20220820065700.png]]


![[Pasted image 20220820065711.png]]
